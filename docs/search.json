[{"path":"https://calcofi.io/calcofi4db/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2025 CalCOFI contributors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://calcofi.io/calcofi4db/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Ben Best. Author, maintainer.","code":""},{"path":"https://calcofi.io/calcofi4db/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Best B (2026). calcofi4db: CalCOFI Database Tools. R package version 2.2.0, https://calcofi.io/calcofi4db.","code":"@Manual{,   title = {calcofi4db: CalCOFI Database Tools},   author = {Ben Best},   year = {2026},   note = {R package version 2.2.0},   url = {https://calcofi.io/calcofi4db}, }"},{"path":"https://calcofi.io/calcofi4db/index.html","id":"calcofi4db","dir":"","previous_headings":"","what":"CalCOFI Database Tools","title":"CalCOFI Database Tools","text":"CalCOFI Database Tools package ingesting managing datasets using modern cloud-native data architecture DuckDB Parquet files.","code":""},{"path":"https://calcofi.io/calcofi4db/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"CalCOFI Database Tools","text":"package provides functions CalCOFI data workflow, uses: Google Cloud Storage (GCS): Versioned data lake immutable archive snapshots Apache Parquet: Efficient columnar storage format large datasets DuckDB: Fast, serverless analytical database DuckLake: Lakehouse catalog time travel versioning","code":""},{"path":"https://calcofi.io/calcofi4db/index.html","id":"architecture","dir":"","previous_headings":"Overview","what":"Architecture","title":"CalCOFI Database Tools","text":"Working DuckLake: Internal database full provenance tracking (_source_file, _source_row, _source_uuid, _ingested_at) Frozen DuckLake: Immutable versioned releases (v2026.02, v2026.03, …) public access","code":"┌─────────────────┐     ┌─────────────────┐     ┌─────────────────┐     ┌─────────────────┐ │   Google Drive  │────▶│      GCS        │────▶│  Working        │────▶│    Frozen       │ │   (raw CSVs)    │     │  (versioned)    │     │  DuckLake       │     │    Releases     │ └─────────────────┘     └─────────────────┘     └─────────────────┘     └─────────────────┘                               rclone                 ingest                  freeze"},{"path":"https://calcofi.io/calcofi4db/index.html","id":"key-features","dir":"","previous_headings":"Overview","what":"Key Features","title":"CalCOFI Database Tools","text":"Reading CSV files GCS immutable archive paths Cloud storage operations (upload, download, version listing) Parquet conversion schema enforcement metadata DuckDB database creation management Provenance tracking data lineage Frozen release creation reproducible data access Data validation releases Backward-compatible PostgreSQL support (deprecated)","code":""},{"path":"https://calcofi.io/calcofi4db/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"CalCOFI Database Tools","text":"","code":"# install from GitHub remotes::install_github(\"CalCOFI/calcofi4db\")"},{"path":[]},{"path":"https://calcofi.io/calcofi4db/index.html","id":"working-with-the-working-ducklake","dir":"","previous_headings":"Usage","what":"Working with the Working DuckLake","title":"CalCOFI Database Tools","text":"Working DuckLake used internally data ingestion automatic provenance tracking:","code":"library(calcofi4db)  # connect to the Working DuckLake con <- get_working_ducklake()  # read CSV from immutable GCS archive csv_path <- get_calcofi_file(   \"swfsc.noaa.gov/calcofi-db/larva.csv\",   date = \"2026-02-02_121557\")  # specific archive snapshot  # read and transform data larvae_data <- readr::read_csv(csv_path)  # ingest with automatic provenance columns stats <- ingest_to_working(  con         = con,   data        = larvae_data,   table       = \"larva\",   source_file = \"archive/2026-02-02_121557/swfsc.noaa.gov/calcofi-db/larva.csv\",   source_uuid_col = \"larva_uuid\",   mode        = \"replace\")  # save changes to GCS save_working_ducklake(con)  # close connection close_duckdb(con)"},{"path":"https://calcofi.io/calcofi4db/index.html","id":"creating-frozen-releases","dir":"","previous_headings":"Usage","what":"Creating Frozen Releases","title":"CalCOFI Database Tools","text":"Frozen releases immutable snapshots public access:","code":"# connect to Working DuckLake con <- get_working_ducklake()  # validate data quality before freezing validation <- validate_for_release(con) if (!validation$passed) {   print(validation$errors)   stop(\"Validation failed\") }  # create frozen release result <- freeze_release(   con           = con,   version       = \"v2026.02\",   release_notes = \"First release with bottle and larvae data.\")  # result contains: version, gcs_path, tables, parquet_files print(result$tables)  close_duckdb(con)"},{"path":"https://calcofi.io/calcofi4db/index.html","id":"listing-and-comparing-releases","dir":"","previous_headings":"Usage","what":"Listing and Comparing Releases","title":"CalCOFI Database Tools","text":"","code":"# list all available frozen releases releases <- list_frozen_releases() print(releases)  # get metadata for a specific release meta <- get_release_metadata(\"v2026.02\") print(meta$tables)  # compare two releases diff <- compare_releases(\"v2026.02\", \"v2026.03\") print(diff$summary)"},{"path":"https://calcofi.io/calcofi4db/index.html","id":"cloud-storage-operations","dir":"","previous_headings":"Usage","what":"Cloud Storage Operations","title":"CalCOFI Database Tools","text":"","code":"# download file from GCS local_file <- get_gcs_file(\"gs://calcofi-files-public/_sync/bottle.csv\")  # upload file to GCS put_gcs_file(\"local/data.parquet\", \"gs://calcofi-db/parquet/data.parquet\")  # list files in bucket files <- list_gcs_files(\"calcofi-files-public\", prefix = \"_sync/\")  # get file from immutable archive snapshot file <- get_calcofi_file(   \"swfsc.noaa.gov/calcofi-db/cruise.csv\",   date = \"latest\")  # or specific timestamp"},{"path":"https://calcofi.io/calcofi4db/index.html","id":"parquet-operations","dir":"","previous_headings":"Usage","what":"Parquet Operations","title":"CalCOFI Database Tools","text":"","code":"# convert CSV to Parquet csv_to_parquet(\"data.csv\", output = \"data.parquet\")  # read Parquet file data <- read_parquet_table(\"data.parquet\")  # write with partitioning write_parquet_table(   data,   \"output/data.parquet\",   partitions = c(\"year\", \"month\"))  # add metadata to Parquet file add_parquet_metadata(   \"data.parquet\",   list(source = \"CalCOFI\", version = \"2026.02\"))"},{"path":"https://calcofi.io/calcofi4db/index.html","id":"basic-duckdb-operations","dir":"","previous_headings":"Usage","what":"Basic DuckDB Operations","title":"CalCOFI Database Tools","text":"","code":"# create in-memory DuckDB con <- get_duckdb_con()  # create from Parquet files con <- create_duckdb_from_parquet(   c(\"parquet/bottle.parquet\", \"parquet/cast.parquet\"),   db_path = \"calcofi.duckdb\")  # add documentation comments set_duckdb_comments(   con,   table = \"bottle\",   table_comment = \"Bottle sample data\",   column_comments = list(     depth_m = \"Sample depth in meters\",     temp_c  = \"Water temperature in Celsius\"))  # export to Parquet duckdb_to_parquet(con, \"bottle\", \"export/bottle.parquet\")  # close connection close_duckdb(con)"},{"path":"https://calcofi.io/calcofi4db/index.html","id":"for-end-users","dir":"","previous_headings":"","what":"For End Users","title":"CalCOFI Database Tools","text":"End users use calcofi4r package access CalCOFI data:","code":"library(calcofi4r)  # connect to latest frozen release con <- cc_get_db()  # or specific version con <- cc_get_db(version = \"v2026.02\")  # convenience functions larvae <- cc_read_larvae() bottles <- cc_read_bottle()  # list available versions cc_list_versions()"},{"path":"https://calcofi.io/calcofi4db/index.html","id":"deprecated-functions","dir":"","previous_headings":"","what":"Deprecated Functions","title":"CalCOFI Database Tools","text":"following PostgreSQL-based functions deprecated emit warnings:","code":""},{"path":"https://calcofi.io/calcofi4db/index.html","id":"documentation","dir":"","previous_headings":"","what":"Documentation","title":"CalCOFI Database Tools","text":"CalCOFI Data Workflow Plan - Full architecture documentation CalCOFI Database Documentation - Database naming conventions schema Package Reference - Function documentation","code":""},{"path":"https://calcofi.io/calcofi4db/index.html","id":"gcs-bucket-structure","dir":"","previous_headings":"","what":"GCS Bucket Structure","title":"CalCOFI Database Tools","text":"","code":"gs://calcofi-files-public/          # versioned source files ├── _sync/                          # working directory (rclone target) ├── archive/                        # immutable snapshots │   └── 2026-02-02_121557/         # timestamp directories └── manifests/                      # JSON manifests  gs://calcofi-db/                    # integrated database ├── ducklake/ │   ├── working/                    # Working DuckLake │   │   └── calcofi.duckdb │   └── releases/                   # Frozen releases │       ├── v2026.02/ │       │   ├── catalog.json │       │   ├── RELEASE_NOTES.md │       │   └── parquet/*.parquet │       └── latest.txt              # points to current release └── parquet/                        # intermediate parquet files"},{"path":"https://calcofi.io/calcofi4db/index.html","id":"license","dir":"","previous_headings":"","what":"License","title":"CalCOFI Database Tools","text":"MIT","code":""},{"path":"https://calcofi.io/calcofi4db/reference/add_parquet_metadata.html","id":null,"dir":"Reference","previous_headings":"","what":"Add metadata to Parquet file — add_parquet_metadata","title":"Add metadata to Parquet file — add_parquet_metadata","text":"Reads Parquet file, adds custom metadata, rewrites .","code":""},{"path":"https://calcofi.io/calcofi4db/reference/add_parquet_metadata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add metadata to Parquet file — add_parquet_metadata","text":"","code":"add_parquet_metadata(path, metadata, output = path)"},{"path":"https://calcofi.io/calcofi4db/reference/add_parquet_metadata.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add metadata to Parquet file — add_parquet_metadata","text":"path Path Parquet file metadata Named list metadata key-value pairs output Output path (default: overwrites input file)","code":""},{"path":"https://calcofi.io/calcofi4db/reference/add_parquet_metadata.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add metadata to Parquet file — add_parquet_metadata","text":"Path modified Parquet file","code":""},{"path":"https://calcofi.io/calcofi4db/reference/add_parquet_metadata.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add metadata to Parquet file — add_parquet_metadata","text":"","code":"if (FALSE) { # \\dontrun{ add_parquet_metadata(   \"parquet/bottle.parquet\",   metadata = list(     source     = \"calcofi.org\",     version    = \"2026.01.31\",     created_by = \"calcofi4db\")) } # }"},{"path":"https://calcofi.io/calcofi4db/reference/add_provenance_columns.html","id":null,"dir":"Reference","previous_headings":"","what":"Add provenance columns to a data frame — add_provenance_columns","title":"Add provenance columns to a data frame — add_provenance_columns","text":"Helper function add provenance tracking columns data frame ingestion. Called internally ingest_to_working().","code":""},{"path":"https://calcofi.io/calcofi4db/reference/add_provenance_columns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add provenance columns to a data frame — add_provenance_columns","text":"","code":"add_provenance_columns(   data,   source_file,   source_row_start = 1,   source_uuid_col = NULL )"},{"path":"https://calcofi.io/calcofi4db/reference/add_provenance_columns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add provenance columns to a data frame — add_provenance_columns","text":"data Data frame modify source_file Path original CSV file archive (e.g., \"archive/2026-02-02_121557/swfsc.noaa.gov/calcofi-db/larva.csv\") source_row_start Starting row number (default: 1, typically 2 skip header) source_uuid_col Column name containing original UUIDs (optional). provided, values copied _source_uuid column.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/add_provenance_columns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add provenance columns to a data frame — add_provenance_columns","text":"Data frame added provenance columns: _source_file (character): Path original CSV _source_row (integer): Row number source file _source_uuid (character): Original record UUID available _ingested_at (POSIXct): row ingested (UTC)","code":""},{"path":"https://calcofi.io/calcofi4db/reference/add_provenance_columns.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add provenance columns to a data frame — add_provenance_columns","text":"","code":"if (FALSE) { # \\dontrun{ data <- tibble::tibble(x = 1:3, y = letters[1:3]) data_prov <- add_provenance_columns(   data        = data,   source_file = \"archive/2026-02-02_121557/swfsc.noaa.gov/calcofi-db/test.csv\",   source_row_start = 2)  # skip header  # with source uuid column data <- tibble::tibble(x = 1:3, uuid = c(\"a1\", \"b2\", \"c3\")) data_prov <- add_provenance_columns(   data            = data,   source_file     = \"test.csv\",   source_uuid_col = \"uuid\") } # }"},{"path":"https://calcofi.io/calcofi4db/reference/apply_data_corrections.html","id":null,"dir":"Reference","previous_headings":"","what":"Apply Data Corrections — apply_data_corrections","title":"Apply Data Corrections — apply_data_corrections","text":"Applies known data corrections database. function updated new corrections identified data managers.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/apply_data_corrections.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Apply Data Corrections — apply_data_corrections","text":"","code":"apply_data_corrections(con, verbose = TRUE)"},{"path":"https://calcofi.io/calcofi4db/reference/apply_data_corrections.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Apply Data Corrections — apply_data_corrections","text":"con DuckDB connection verbose Print correction messages (default: TRUE)","code":""},{"path":"https://calcofi.io/calcofi4db/reference/apply_data_corrections.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Apply Data Corrections — apply_data_corrections","text":"Invisibly returns connection","code":""},{"path":"https://calcofi.io/calcofi4db/reference/apply_data_corrections.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Apply Data Corrections — apply_data_corrections","text":"","code":"if (FALSE) { # \\dontrun{ con <- get_duckdb_con() apply_data_corrections(con) } # }"},{"path":"https://calcofi.io/calcofi4db/reference/assign_sequential_ids.html","id":null,"dir":"Reference","previous_headings":"","what":"Assign Sequential IDs with Deterministic Sort Order — assign_sequential_ids","title":"Assign Sequential IDs with Deterministic Sort Order — assign_sequential_ids","text":"Assigns sequential integer IDs table based specified sort order. ensures reproducibility appending new data - data always get IDs.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/assign_sequential_ids.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Assign Sequential IDs with Deterministic Sort Order — assign_sequential_ids","text":"","code":"assign_sequential_ids(con, table_name, id_col = NULL, sort_cols, start_id = 1)"},{"path":"https://calcofi.io/calcofi4db/reference/assign_sequential_ids.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Assign Sequential IDs with Deterministic Sort Order — assign_sequential_ids","text":"con DuckDB connection table_name Name table assign IDs id_col Name ID column create (default: paste0(table_name, \"_id\")) sort_cols Character vector columns sort ID assignment start_id Starting ID value (default: 1)","code":""},{"path":"https://calcofi.io/calcofi4db/reference/assign_sequential_ids.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Assign Sequential IDs with Deterministic Sort Order — assign_sequential_ids","text":"Invisibly returns connection adding ID column","code":""},{"path":"https://calcofi.io/calcofi4db/reference/assign_sequential_ids.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Assign Sequential IDs with Deterministic Sort Order — assign_sequential_ids","text":"","code":"if (FALSE) { # \\dontrun{ con <- get_duckdb_con()  # assign site_id sorted by cruise_key and orderocc assign_sequential_ids(   con        = con,   table_name = \"site\",   id_col     = \"site_id\",   sort_cols  = c(\"cruise_key\", \"orderocc\"))  # assign ichthyo_id with multi-column sort assign_sequential_ids(   con        = con,   table_name = \"ichthyo\",   id_col     = \"ichthyo_id\",   sort_cols  = c(\"net_id\", \"species_id\", \"life_stage\",                  \"measurement_type\", \"measurement_value\")) } # }"},{"path":"https://calcofi.io/calcofi4db/reference/calcofi4db-package.html","id":null,"dir":"Reference","previous_headings":"","what":"calcofi4db: CalCOFI Database Tools — calcofi4db-package","title":"calcofi4db: CalCOFI Database Tools — calcofi4db-package","text":"Tools ingesting datasets CalCOFI database functions read source CSV files, detect changes tables fields, update database proper metadata. Includes cloud storage (GCS), Parquet, DuckDB operations modern data workflows.","code":""},{"path":[]},{"path":"https://calcofi.io/calcofi4db/reference/calcofi4db-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"calcofi4db: CalCOFI Database Tools — calcofi4db-package","text":"Maintainer: Ben Best ben@ecoquants.com (ORCID)","code":""},{"path":"https://calcofi.io/calcofi4db/reference/check_data_integrity.html","id":null,"dir":"Reference","previous_headings":"","what":"Check Data Integrity for Ingestion — check_data_integrity","title":"Check Data Integrity for Ingestion — check_data_integrity","text":"Validates CSV files match redefinition metadata database ingestion. function designed called Quarto notebooks stop notebook execution mismatches detected.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/check_data_integrity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check Data Integrity for Ingestion — check_data_integrity","text":"","code":"check_data_integrity(   d,   dataset_name = \"Dataset\",   halt_on_fail = TRUE,   display_format = \"DT\",   verbose = TRUE )"},{"path":"https://calcofi.io/calcofi4db/reference/check_data_integrity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check Data Integrity for Ingestion — check_data_integrity","text":"d List output read_csv_files() containing CSV redefinition data dataset_name Name dataset display purposes (e.g., \"NOAA CalCOFI Database\") halt_on_fail Logical, whether set knitr eval=FALSE failure (default: TRUE) display_format Format displaying changes: \"DT\" (DataTable), \"kable\", \"print\" (default: \"DT\") verbose Logical, print detailed messages (default: TRUE)","code":""},{"path":"https://calcofi.io/calcofi4db/reference/check_data_integrity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check Data Integrity for Ingestion — check_data_integrity","text":"List : passed: Logical indicating integrity check passed changes: Full changes object detect_csv_changes() n_changes: Number changes detected message: Character string markdown-formatted message","code":""},{"path":"https://calcofi.io/calcofi4db/reference/check_data_integrity.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Check Data Integrity for Ingestion — check_data_integrity","text":"function: Detects changes CSV files redefinitions using detect_csv_changes() Prints summary statistics detected changes Displays interactive table changes exist Returns appropriate status notebook control flow called Quarto notebook output: asis chunk, function render markdown messages can control chunk evaluation via knitr options.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/check_data_integrity.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Check Data Integrity for Ingestion — check_data_integrity","text":"","code":"if (FALSE) { # \\dontrun{ # In a Quarto notebook chunk with output: asis d_noaa <- read_csv_files(\"swfsc.noaa.gov\", \"calcofi-db\") integrity_check <- check_data_integrity(   d = d_noaa,   dataset_name = \"NOAA CalCOFI Database\" )  # Continue only if check passed if (!integrity_check$passed) {   stop(\"Data integrity check failed\") } } # }"},{"path":"https://calcofi.io/calcofi4db/reference/check_multiple_datasets.html","id":null,"dir":"Reference","previous_headings":"","what":"Check Multiple Datasets for Integrity — check_multiple_datasets","title":"Check Multiple Datasets for Integrity — check_multiple_datasets","text":"Convenience function check integrity multiple datasets halt fail. Useful master ingestion scripts multiple datasets.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/check_multiple_datasets.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check Multiple Datasets for Integrity — check_multiple_datasets","text":"","code":"check_multiple_datasets(   datasets,   halt_on_first_fail = FALSE,   display_format = \"DT\" )"},{"path":"https://calcofi.io/calcofi4db/reference/check_multiple_datasets.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check Multiple Datasets for Integrity — check_multiple_datasets","text":"datasets Named list names dataset labels values outputs read_csv_files() halt_on_first_fail Logical, stop checking first failure (default: FALSE) display_format Format displaying changes (default: \"DT\")","code":""},{"path":"https://calcofi.io/calcofi4db/reference/check_multiple_datasets.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check Multiple Datasets for Integrity — check_multiple_datasets","text":"List : all_passed: Logical indicating checks passed results: Named list individual check results n_failed: Number datasets failed failed_datasets: Character vector failed dataset names","code":""},{"path":"https://calcofi.io/calcofi4db/reference/check_multiple_datasets.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Check Multiple Datasets for Integrity — check_multiple_datasets","text":"","code":"if (FALSE) { # \\dontrun{ datasets <- list(   \"NOAA CalCOFI DB\" = d_noaa,   \"Bottle Database\" = d_bottle ) check_results <- check_multiple_datasets(datasets)  if (!check_results$all_passed) {   stop(\"One or more datasets failed integrity checks\") } } # }"},{"path":"https://calcofi.io/calcofi4db/reference/close_duckdb.html","id":null,"dir":"Reference","previous_headings":"","what":"Disconnect from DuckDB and shutdown — close_duckdb","title":"Disconnect from DuckDB and shutdown — close_duckdb","text":"Properly closes DuckDB connection shuts database.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/close_duckdb.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Disconnect from DuckDB and shutdown — close_duckdb","text":"","code":"close_duckdb(con, checkpoint = NULL)"},{"path":"https://calcofi.io/calcofi4db/reference/close_duckdb.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Disconnect from DuckDB and shutdown — close_duckdb","text":"con DuckDB connection checkpoint Run checkpoint closing (default: TRUE writeable connections)","code":""},{"path":"https://calcofi.io/calcofi4db/reference/close_duckdb.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Disconnect from DuckDB and shutdown — close_duckdb","text":"NULL (invisibly)","code":""},{"path":"https://calcofi.io/calcofi4db/reference/close_duckdb.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Disconnect from DuckDB and shutdown — close_duckdb","text":"","code":"if (FALSE) { # \\dontrun{ close_duckdb(con) } # }"},{"path":"https://calcofi.io/calcofi4db/reference/commit_version_and_permalink.html","id":null,"dir":"Reference","previous_headings":"","what":"Commit Version Changes and Get Permalink — commit_version_and_permalink","title":"Commit Version Changes and Get Permalink — commit_version_and_permalink","text":"Commits DESCRIPTION, NEWS.md, specified files git, generates GitHub permalink ingestion script committed version.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/commit_version_and_permalink.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Commit Version Changes and Get Permalink — commit_version_and_permalink","text":"","code":"commit_version_and_permalink(   version,   files = NULL,   repo_owner = \"CalCOFI\",   repo_name = \"calcofi4db\",   script_path = \"inst/create_db.qmd\",   commit = FALSE,   push = FALSE )"},{"path":"https://calcofi.io/calcofi4db/reference/commit_version_and_permalink.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Commit Version Changes and Get Permalink — commit_version_and_permalink","text":"version Version number commit message files Additional files commit (e.g., \"inst/create_db.qmd\") repo_owner GitHub repository owner (default: \"CalCOFI\") repo_name GitHub repository name (default: \"calcofi4db\") script_path Path script permalink (default: \"inst/create_db.qmd\") commit Logical, whether actually commit (default: FALSE safety) push Logical, whether push remote (default: FALSE safety)","code":""},{"path":"https://calcofi.io/calcofi4db/reference/commit_version_and_permalink.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Commit Version Changes and Get Permalink — commit_version_and_permalink","text":"List commit hash permalink","code":""},{"path":"https://calcofi.io/calcofi4db/reference/commit_version_and_permalink.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Commit Version Changes and Get Permalink — commit_version_and_permalink","text":"","code":"if (FALSE) { # \\dontrun{ # Dry run (no commit) result <- commit_version_and_permalink(   version = \"1.0.0\",   files = c(\"inst/create_db.qmd\", \"inst/schema_version.csv\") )  # Actually commit and push result <- commit_version_and_permalink(   version = \"1.0.0\",   files = c(\"inst/create_db.qmd\", \"inst/schema_version.csv\"),   commit = TRUE,   push = TRUE ) } # }"},{"path":"https://calcofi.io/calcofi4db/reference/compare_local_vs_archive.html","id":null,"dir":"Reference","previous_headings":"","what":"Compare local files with GCS archive — compare_local_vs_archive","title":"Compare local files with GCS archive — compare_local_vs_archive","text":"Compares local CSV files GCS archive detect changes.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/compare_local_vs_archive.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compare local files with GCS archive — compare_local_vs_archive","text":"","code":"compare_local_vs_archive(   dir_csv,   archive_timestamp,   provider,   dataset,   gcs_bucket = \"calcofi-files-public\",   archive_prefix = \"archive\" )"},{"path":"https://calcofi.io/calcofi4db/reference/compare_local_vs_archive.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compare local files with GCS archive — compare_local_vs_archive","text":"dir_csv Local directory containing CSV files archive_timestamp Archive timestamp compare provider Data provider dataset Dataset name gcs_bucket GCS bucket name archive_prefix Archive folder prefix","code":""},{"path":"https://calcofi.io/calcofi4db/reference/compare_local_vs_archive.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compare local files with GCS archive — compare_local_vs_archive","text":"List : matches: Logical, TRUE local matches archive local_manifest: Tibble local files archive_manifest: Tibble archive files added: Files local archive removed: Files archive local changed: Files different sizes","code":""},{"path":"https://calcofi.io/calcofi4db/reference/compare_local_vs_archive.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compare local files with GCS archive — compare_local_vs_archive","text":"","code":"if (FALSE) { # \\dontrun{ comparison <- compare_local_vs_archive(   dir_csv = \"/path/to/csv\",   archive_timestamp = \"2026-02-02_121557\",   provider = \"swfsc.noaa.gov\",   dataset = \"calcofi-db\")  if (!comparison$matches) {   message(\"Local files have changed since archive\") } } # }"},{"path":"https://calcofi.io/calcofi4db/reference/compare_releases.html","id":null,"dir":"Reference","previous_headings":"","what":"Compare two frozen releases — compare_releases","title":"Compare two frozen releases — compare_releases","text":"Generates diff report two frozen releases showing added, removed, modified tables schema changes.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/compare_releases.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compare two frozen releases — compare_releases","text":"","code":"compare_releases(v1, v2, bucket = \"calcofi-db\")"},{"path":"https://calcofi.io/calcofi4db/reference/compare_releases.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compare two frozen releases — compare_releases","text":"v1 First version string (e.g., \"v2026.02\") v2 Second version string (e.g., \"v2026.03\") bucket GCS bucket name (default: \"calcofi-db\")","code":""},{"path":"https://calcofi.io/calcofi4db/reference/compare_releases.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compare two frozen releases — compare_releases","text":"List : summary: Tibble table-level summary (table, rows_v1, rows_v2, change) tables_added: Tables v2 v1 tables_removed: Tables v1 v2 row_changes: Tibble row count changes","code":""},{"path":"https://calcofi.io/calcofi4db/reference/compare_releases.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compare two frozen releases — compare_releases","text":"","code":"if (FALSE) { # \\dontrun{ diff <- compare_releases(\"v2026.02\", \"v2026.03\") diff$summary diff$tables_added } # }"},{"path":"https://calcofi.io/calcofi4db/reference/complete_version_release.html","id":null,"dir":"Reference","previous_headings":"","what":"Complete Version Release Workflow — complete_version_release","title":"Complete Version Release Workflow — complete_version_release","text":"Performs complete version release workflow: Updates package DESCRIPTION NEWS.md Commits changes git Records schema version database Updates schema_version.csv","code":""},{"path":"https://calcofi.io/calcofi4db/reference/complete_version_release.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Complete Version Release Workflow — complete_version_release","text":"","code":"complete_version_release(   con,   schema = \"dev\",   version,   description,   news_items = NULL,   additional_files = NULL,   commit = FALSE,   push = FALSE,   repo_owner = \"CalCOFI\",   repo_name = \"calcofi4db\" )"},{"path":"https://calcofi.io/calcofi4db/reference/complete_version_release.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Complete Version Release Workflow — complete_version_release","text":"con Database connection schema Database schema (default: \"dev\") version New version number description Version description news_items News items NEWS.md (optional) additional_files Additional files commit (optional) commit Logical, whether commit (default: FALSE) push Logical, whether push (default: FALSE) repo_owner GitHub owner (default: \"CalCOFI\") repo_name GitHub repo (default: \"calcofi4db\")","code":""},{"path":"https://calcofi.io/calcofi4db/reference/complete_version_release.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Complete Version Release Workflow — complete_version_release","text":"List version info, commit details, database record","code":""},{"path":"https://calcofi.io/calcofi4db/reference/complete_version_release.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Complete Version Release Workflow — complete_version_release","text":"","code":"if (FALSE) { # \\dontrun{ # Complete release workflow release_result <- complete_version_release(   con = con_dev,   schema = \"dev\",   version = \"1.0.0\",   description = \"Initial production release with NOAA CalCOFI Database\",   news_items = c(     \"Complete NOAA CalCOFI Database ingestion\",     \"Add synchronized versioning system\",     \"Create master ingestion workflow\"   ),   additional_files = c(\"inst/create_db.qmd\", \"inst/schema_version.csv\"),   commit = TRUE,   push = TRUE ) } # }"},{"path":"https://calcofi.io/calcofi4db/reference/consolidate_ichthyo_tables.html","id":null,"dir":"Reference","previous_headings":"","what":"Consolidate Ichthyoplankton Tables into Tidy Format — consolidate_ichthyo_tables","title":"Consolidate Ichthyoplankton Tables into Tidy Format — consolidate_ichthyo_tables","text":"Transforms 5 separate ichthyoplankton tables (egg, eggstage, larva, larvastage, larvasize) single tidy table columns: net_uuid, species_id, life_stage, measurement_type, measurement_value, tally.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/consolidate_ichthyo_tables.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Consolidate Ichthyoplankton Tables into Tidy Format — consolidate_ichthyo_tables","text":"","code":"consolidate_ichthyo_tables(   con,   output_tbl = \"ichthyo\",   egg_tbl = \"egg\",   eggstage_tbl = \"egg_stage\",   larva_tbl = \"larva\",   larvastage_tbl = \"larva_stage\",   larvasize_tbl = \"larva_size\",   larva_stage_vocab = NULL,   net_id_col = \"net_uuid\" )"},{"path":"https://calcofi.io/calcofi4db/reference/consolidate_ichthyo_tables.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Consolidate Ichthyoplankton Tables into Tidy Format — consolidate_ichthyo_tables","text":"con DuckDB connection output_tbl Name output table (default: \"ichthyo\") egg_tbl Name egg totals table (default: \"egg\") eggstage_tbl Name egg stage table (default: \"egg_stage\") larva_tbl Name larva totals table (default: \"larva\") larvastage_tbl Name larva stage table (default: \"larva_stage\") larvasize_tbl Name larva size table (default: \"larva_size\") larva_stage_vocab Tibble mapping stage text (YOLK, PREF, etc.) integers net_id_col Name net identifier column source tables (default: \"net_uuid\")","code":""},{"path":"https://calcofi.io/calcofi4db/reference/consolidate_ichthyo_tables.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Consolidate Ichthyoplankton Tables into Tidy Format — consolidate_ichthyo_tables","text":"Invisibly returns connection creating ichthyo table","code":""},{"path":"https://calcofi.io/calcofi4db/reference/consolidate_ichthyo_tables.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Consolidate Ichthyoplankton Tables into Tidy Format — consolidate_ichthyo_tables","text":"calling function, use replace_uuid_with_id() convert net_uuid net_id, assign_sequential_ids() add ichthyo_id.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/consolidate_ichthyo_tables.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Consolidate Ichthyoplankton Tables into Tidy Format — consolidate_ichthyo_tables","text":"","code":"if (FALSE) { # \\dontrun{ larva_vocab <- tibble::tibble(   stage_txt = c(\"YOLK\", \"PREF\", \"FLEX\", \"POST\", \"TRNS\"),   stage_int = 1:5)  consolidate_ichthyo_tables(   con               = con,   larva_stage_vocab = larva_vocab)  # then convert net_uuid to net_id replace_uuid_with_id(   con          = con,   table_name   = \"ichthyo\",   uuid_col     = \"net_uuid\",   new_id_col   = \"net_id\",   ref_table    = \"net\",   ref_uuid_col = \"net_uuid\",   ref_id_col   = \"net_id\") } # }"},{"path":"https://calcofi.io/calcofi4db/reference/copy_schema.html","id":null,"dir":"Reference","previous_headings":"","what":"Copy Database Schema — copy_schema","title":"Copy Database Schema — copy_schema","text":"Copies database schema tables, data, sequences, constraints new schema. Useful promoting dev prod.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/copy_schema.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Copy Database Schema — copy_schema","text":"","code":"copy_schema(   con,   from_schema = \"dev\",   to_schema = \"prod\",   drop_existing = TRUE,   copy_fk = TRUE,   verbose = TRUE )"},{"path":"https://calcofi.io/calcofi4db/reference/copy_schema.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Copy Database Schema — copy_schema","text":"con Database connection from_schema Source schema name (default: \"dev\") to_schema Destination schema name (default: \"prod\") drop_existing Logical, drop existing destination schema (default: TRUE) copy_fk Logical, copy foreign key constraints (default: TRUE) verbose Logical, print progress messages (default: TRUE)","code":""},{"path":"https://calcofi.io/calcofi4db/reference/copy_schema.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Copy Database Schema — copy_schema","text":"List copy summary statistics","code":""},{"path":"https://calcofi.io/calcofi4db/reference/copy_schema.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Copy Database Schema — copy_schema","text":"","code":"if (FALSE) { # \\dontrun{ # Copy dev to prod result <- copy_schema(con, from_schema = \"dev\", to_schema = \"prod\")  # Check results result$summary } # }"},{"path":"https://calcofi.io/calcofi4db/reference/create_cruise_key.html","id":null,"dir":"Reference","previous_headings":"","what":"Create Cruise Key from Ship Key and Date — create_cruise_key","title":"Create Cruise Key from Ship Key and Date — create_cruise_key","text":"Creates natural key cruises format YYMMKK : YY = 2-digit year MM = 2-digit month KK = 2-letter ship key","code":""},{"path":"https://calcofi.io/calcofi4db/reference/create_cruise_key.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create Cruise Key from Ship Key and Date — create_cruise_key","text":"","code":"create_cruise_key(   con,   cruise_tbl = \"cruise\",   ship_tbl = \"ship\",   date_col = \"date_ym\" )"},{"path":"https://calcofi.io/calcofi4db/reference/create_cruise_key.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create Cruise Key from Ship Key and Date — create_cruise_key","text":"con DuckDB connection cruise_tbl Name cruise table (default: \"cruise\") ship_tbl Name ship table (default: \"ship\") date_col Name date column cruise table (default: \"date_ym\")","code":""},{"path":"https://calcofi.io/calcofi4db/reference/create_cruise_key.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create Cruise Key from Ship Key and Date — create_cruise_key","text":"Invisibly returns connection adding cruise_key column","code":""},{"path":"https://calcofi.io/calcofi4db/reference/create_cruise_key.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create Cruise Key from Ship Key and Date — create_cruise_key","text":"","code":"if (FALSE) { # \\dontrun{ con <- get_duckdb_con() create_cruise_key(con) } # }"},{"path":"https://calcofi.io/calcofi4db/reference/create_duckdb_from_parquet.html","id":null,"dir":"Reference","previous_headings":"","what":"Create DuckDB from Parquet files — create_duckdb_from_parquet","title":"Create DuckDB from Parquet files — create_duckdb_from_parquet","text":"Creates updates DuckDB database collection Parquet files.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/create_duckdb_from_parquet.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create DuckDB from Parquet files — create_duckdb_from_parquet","text":"","code":"create_duckdb_from_parquet(   parquet_files,   db_path = \":memory:\",   table_names = NULL )"},{"path":"https://calcofi.io/calcofi4db/reference/create_duckdb_from_parquet.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create DuckDB from Parquet files — create_duckdb_from_parquet","text":"parquet_files Named list vector Parquet file paths db_path Path DuckDB file (default: \":memory:\") table_names Optional table names (default: derived file names)","code":""},{"path":"https://calcofi.io/calcofi4db/reference/create_duckdb_from_parquet.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create DuckDB from Parquet files — create_duckdb_from_parquet","text":"DuckDB connection loaded tables","code":""},{"path":"https://calcofi.io/calcofi4db/reference/create_duckdb_from_parquet.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create DuckDB from Parquet files — create_duckdb_from_parquet","text":"","code":"if (FALSE) { # \\dontrun{ # create from multiple parquet files con <- create_duckdb_from_parquet(   c(\"parquet/bottle.parquet\", \"parquet/cast.parquet\"),   db_path = \"calcofi.duckdb\")  # with explicit table names con <- create_duckdb_from_parquet(   parquet_files = c(     bottle = \"parquet/bottle.parquet\",     cast   = \"parquet/cast.parquet\"),   db_path = \"calcofi.duckdb\") } # }"},{"path":"https://calcofi.io/calcofi4db/reference/create_duckdb_views.html","id":null,"dir":"Reference","previous_headings":"","what":"Create views from a manifest — create_duckdb_views","title":"Create views from a manifest — create_duckdb_views","text":"Creates DuckDB views pointing Parquet files defined manifest.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/create_duckdb_views.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create views from a manifest — create_duckdb_views","text":"","code":"create_duckdb_views(con, manifest)"},{"path":"https://calcofi.io/calcofi4db/reference/create_duckdb_views.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create views from a manifest — create_duckdb_views","text":"con DuckDB connection manifest List data frame table definitions","code":""},{"path":"https://calcofi.io/calcofi4db/reference/create_duckdb_views.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create views from a manifest — create_duckdb_views","text":"connection object (invisibly)","code":""},{"path":"https://calcofi.io/calcofi4db/reference/create_duckdb_views.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create views from a manifest — create_duckdb_views","text":"","code":"if (FALSE) { # \\dontrun{ manifest <- list(   tables = list(     list(name = \"bottle\", path = \"parquet/bottle.parquet\"),     list(name = \"cast\",   path = \"parquet/cast.parquet\")))  con <- get_duckdb_con() create_duckdb_views(con, manifest) } # }"},{"path":"https://calcofi.io/calcofi4db/reference/create_gcs_manifest.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a manifest of current GCS files — create_gcs_manifest","title":"Create a manifest of current GCS files — create_gcs_manifest","text":"Generates JSON manifest documenting current state files GCS.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/create_gcs_manifest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a manifest of current GCS files — create_gcs_manifest","text":"","code":"create_gcs_manifest(   bucket = \"calcofi-files\",   prefix = \"current/\",   output_path = NULL )"},{"path":"https://calcofi.io/calcofi4db/reference/create_gcs_manifest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a manifest of current GCS files — create_gcs_manifest","text":"bucket GCS bucket name (default: \"calcofi-files\") prefix Path prefix include (default: \"current/\") output_path Path save manifest JSON (default: NULL returns data)","code":""},{"path":"https://calcofi.io/calcofi4db/reference/create_gcs_manifest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a manifest of current GCS files — create_gcs_manifest","text":"Data frame file metadata, path saved JSON","code":""},{"path":"https://calcofi.io/calcofi4db/reference/create_gcs_manifest.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a manifest of current GCS files — create_gcs_manifest","text":"","code":"if (FALSE) { # \\dontrun{ manifest <- create_gcs_manifest() create_gcs_manifest(output_path = \"manifest_2026-01-31.json\") } # }"},{"path":"https://calcofi.io/calcofi4db/reference/create_lookup_table.html","id":null,"dir":"Reference","previous_headings":"","what":"Create Lookup Table from Vocabulary Definitions — create_lookup_table","title":"Create Lookup Table from Vocabulary Definitions — create_lookup_table","text":"Creates unified lookup table vocabulary definitions egg stages, larva stages, tow types.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/create_lookup_table.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create Lookup Table from Vocabulary Definitions — create_lookup_table","text":"","code":"create_lookup_table(   con,   lookup_tbl = \"lookup\",   egg_stage_vocab = NULL,   larva_stage_vocab = NULL,   tow_type_vocab = NULL )"},{"path":"https://calcofi.io/calcofi4db/reference/create_lookup_table.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create Lookup Table from Vocabulary Definitions — create_lookup_table","text":"con DuckDB connection lookup_tbl Name lookup table create (default: \"lookup\") egg_stage_vocab Tibble egg stage vocabulary (columns: stage_int, stage_description) larva_stage_vocab Tibble larva stage vocabulary (columns: stage_int, stage_txt, stage_description) tow_type_vocab Optional tibble tow type vocabulary (columns: lookup_num, lookup_chr, description)","code":""},{"path":"https://calcofi.io/calcofi4db/reference/create_lookup_table.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create Lookup Table from Vocabulary Definitions — create_lookup_table","text":"Invisibly returns connection creating lookup table","code":""},{"path":"https://calcofi.io/calcofi4db/reference/create_lookup_table.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create Lookup Table from Vocabulary Definitions — create_lookup_table","text":"","code":"if (FALSE) { # \\dontrun{ egg_vocab <- tibble::tibble(   stage_int = 1:11,   stage_description = paste0(\"egg, stage \", 1:11, \" of 11 (Moser & Ahlstrom, 1985)\"))  larva_vocab <- tibble::tibble(   stage_int = 1:5,   stage_txt = c(\"YOLK\", \"PREF\", \"FLEX\", \"POST\", \"TRNS\"),   stage_description = c(     \"larva, yolk sac\",     \"larva, preflexion\",     \"larva, flexion\",     \"larva, postflexion\",     \"larva, transformation\"))  create_lookup_table(con, egg_stage_vocab = egg_vocab, larva_stage_vocab = larva_vocab) } # }"},{"path":"https://calcofi.io/calcofi4db/reference/create_redefinition_files.html","id":null,"dir":"Reference","previous_headings":"","what":"Create Redefinition Files for Tables and Fields — create_redefinition_files","title":"Create Redefinition Files for Tables and Fields — create_redefinition_files","text":"Creates redefinition files tables fields exist.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/create_redefinition_files.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create Redefinition Files for Tables and Fields — create_redefinition_files","text":"","code":"create_redefinition_files(d_tbls_in, d_flds_in, d, tbls_rd_csv, flds_rd_csv)"},{"path":"https://calcofi.io/calcofi4db/reference/create_redefinition_files.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create Redefinition Files for Tables and Fields — create_redefinition_files","text":"d_tbls_in Data frame table metadata d_flds_in Data frame field metadata d Data frame raw data tbls_rd_csv Path table redefinition CSV file flds_rd_csv Path field redefinition CSV file","code":""},{"path":"https://calcofi.io/calcofi4db/reference/create_redefinition_files.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create Redefinition Files for Tables and Fields — create_redefinition_files","text":"Invisible NULL (files written disk)","code":""},{"path":"https://calcofi.io/calcofi4db/reference/create_redefinition_files.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create Redefinition Files for Tables and Fields — create_redefinition_files","text":"","code":"if (FALSE) { # \\dontrun{ create_redefinition_files(   d_tbls_in = tables_metadata,   d_flds_in = fields_metadata,   d = raw_data,   tbls_rd_csv = \"path/to/tbls_redefine.csv\",   flds_rd_csv = \"path/to/flds_redefine.csv\" ) } # }"},{"path":"https://calcofi.io/calcofi4db/reference/csv_to_parquet.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert CSV file to Parquet format — csv_to_parquet","title":"Convert CSV file to Parquet format — csv_to_parquet","text":"Reads CSV file writes Parquet optional schema enforcement. Parquet provides efficient columnar storage compression.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/csv_to_parquet.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert CSV file to Parquet format — csv_to_parquet","text":"","code":"csv_to_parquet(   csv_path,   output = NULL,   schema_def = NULL,   compression = \"snappy\",   col_types = NULL )"},{"path":"https://calcofi.io/calcofi4db/reference/csv_to_parquet.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert CSV file to Parquet format — csv_to_parquet","text":"csv_path Path CSV file (local GCS) output Path output Parquet file. NULL, uses name .parquet extension schema_def Optional schema definition (arrow::schema object list) compression Compression codec (default: \"snappy\") col_types Column type specification readr (optional)","code":""},{"path":"https://calcofi.io/calcofi4db/reference/csv_to_parquet.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert CSV file to Parquet format — csv_to_parquet","text":"Path created Parquet file","code":""},{"path":"https://calcofi.io/calcofi4db/reference/csv_to_parquet.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert CSV file to Parquet format — csv_to_parquet","text":"","code":"if (FALSE) { # \\dontrun{ # basic conversion pqt_file <- csv_to_parquet(\"data/bottle.csv\")  # with custom output path pqt_file <- csv_to_parquet(   \"data/bottle.csv\",   output = \"parquet/bottle.parquet\")  # with explicit schema schema <- arrow::schema(   cruise_id = arrow::int32(),   station   = arrow::string(),   depth     = arrow::float64()) pqt_file <- csv_to_parquet(\"data/bottle.csv\", schema_def = schema) } # }"},{"path":"https://calcofi.io/calcofi4db/reference/delete_flagged_rows.html","id":null,"dir":"Reference","previous_headings":"","what":"Delete Flagged Rows from Database — delete_flagged_rows","title":"Delete Flagged Rows from Database — delete_flagged_rows","text":"Removes rows flagged validation database tables. called reviewing flagged files clean invalid data.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/delete_flagged_rows.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Delete Flagged Rows from Database — delete_flagged_rows","text":"","code":"delete_flagged_rows(   con,   validation_results,   tables_to_clean = NULL,   dry_run = TRUE )"},{"path":"https://calcofi.io/calcofi4db/reference/delete_flagged_rows.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Delete Flagged Rows from Database — delete_flagged_rows","text":"con DuckDB connection validation_results Results validate_dataset() tables_to_clean Optional character vector table names clean. NULL (default), cleans tables flagged rows. dry_run TRUE (default), reports deleted without actually deleting. Set FALSE perform deletion.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/delete_flagged_rows.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Delete Flagged Rows from Database — delete_flagged_rows","text":"Tibble deletion statistics per table","code":""},{"path":"https://calcofi.io/calcofi4db/reference/delete_flagged_rows.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Delete Flagged Rows from Database — delete_flagged_rows","text":"","code":"if (FALSE) { # \\dontrun{ # first, run validation results <- validate_dataset(con, validations)  # dry run to see what would be deleted delete_flagged_rows(con, results, dry_run = TRUE)  # actually delete delete_flagged_rows(con, results, dry_run = FALSE) } # }"},{"path":"https://calcofi.io/calcofi4db/reference/detect_csv_changes.html","id":null,"dir":"Reference","previous_headings":"","what":"Detect Changes in CSV Files — detect_csv_changes","title":"Detect Changes in CSV Files — detect_csv_changes","text":"Compares latest CSV files redefinition metadata detect changes tables, fields, data types. function compares raw CSV data (d$d_csv) table field redefinitions (d$d_tbls_rd d$d_flds_rd) identify mismatches database ingestion.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/detect_csv_changes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Detect Changes in CSV Files — detect_csv_changes","text":"","code":"detect_csv_changes(d)"},{"path":"https://calcofi.io/calcofi4db/reference/detect_csv_changes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Detect Changes in CSV Files — detect_csv_changes","text":"d List output read_csv_files() containing: d_csv: CSV metadata tables, fields, data d_tbls_rd: Table redefinition data frame d_flds_rd: Field redefinition data frame","code":""},{"path":"https://calcofi.io/calcofi4db/reference/detect_csv_changes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Detect Changes in CSV Files — detect_csv_changes","text":"list containing detected changes: tables_added: Tables CSV redefinitions tables_removed: Tables redefinitions CSV fields_added: Fields CSV redefinitions (table) fields_removed: Fields redefinitions CSV (table) type_mismatches: Field type differences CSV redefinitions summary: Data frame summarizing changes display","code":""},{"path":"https://calcofi.io/calcofi4db/reference/detect_csv_changes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Detect Changes in CSV Files — detect_csv_changes","text":"","code":"if (FALSE) { # \\dontrun{ # Read CSV files and metadata d <- read_csv_files(\"swfsc.noaa.gov\", \"calcofi-db\")  # Detect changes between CSV files and redefinitions changes <- detect_csv_changes(d)  # Display summary of changes print(changes$summary) } # }"},{"path":"https://calcofi.io/calcofi4db/reference/determine_field_types.html","id":null,"dir":"Reference","previous_headings":"","what":"Determine Field Types for Database — determine_field_types","title":"Determine Field Types for Database — determine_field_types","text":"Determines appropriate PostgreSQL data types fields based data values.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/determine_field_types.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Determine Field Types for Database — determine_field_types","text":"","code":"determine_field_types(d, tbl, fld)"},{"path":"https://calcofi.io/calcofi4db/reference/determine_field_types.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Determine Field Types for Database — determine_field_types","text":"d Data frame raw data tbl Table name fld Field name","code":""},{"path":"https://calcofi.io/calcofi4db/reference/determine_field_types.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Determine Field Types for Database — determine_field_types","text":"Character vector PostgreSQL data types","code":""},{"path":"https://calcofi.io/calcofi4db/reference/determine_field_types.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Determine Field Types for Database — determine_field_types","text":"","code":"if (FALSE) { # \\dontrun{ determine_field_types(raw_data, \"species\", \"species_name\") } # }"},{"path":"https://calcofi.io/calcofi4db/reference/display_csv_changes.html","id":null,"dir":"Reference","previous_headings":"","what":"Display CSV Changes in a Formatted Table — display_csv_changes","title":"Display CSV Changes in a Formatted Table — display_csv_changes","text":"Creates formatted table showing changes detected CSV files redefinitions. Changes color-coded: additions green, removals red, type mismatches orange.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/display_csv_changes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Display CSV Changes in a Formatted Table — display_csv_changes","text":"","code":"display_csv_changes(changes, format = \"DT\", title = NULL)"},{"path":"https://calcofi.io/calcofi4db/reference/display_csv_changes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Display CSV Changes in a Formatted Table — display_csv_changes","text":"changes List output detect_csv_changes() containing change information format Output format: \"DT\" interactive DataTable (default), \"kable\" static knitr table, \"tibble\" raw data frame title Optional title table","code":""},{"path":"https://calcofi.io/calcofi4db/reference/display_csv_changes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Display CSV Changes in a Formatted Table — display_csv_changes","text":"Formatted table object (DT, kable, tibble) showing changes","code":""},{"path":"https://calcofi.io/calcofi4db/reference/display_csv_changes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Display CSV Changes in a Formatted Table — display_csv_changes","text":"","code":"if (FALSE) { # \\dontrun{ # Read CSV files and detect changes d <- read_csv_files(\"swfsc.noaa.gov\", \"calcofi-db\") changes <- detect_csv_changes(d)  # Display interactive table display_csv_changes(changes)  # Display static table for reports display_csv_changes(changes, format = \"kable\") } # }"},{"path":"https://calcofi.io/calcofi4db/reference/download_archive.html","id":null,"dir":"Reference","previous_headings":"","what":"Download archive to local directory — download_archive","title":"Download archive to local directory — download_archive","text":"Downloads CSV files GCS archive local directory.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/download_archive.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Download archive to local directory — download_archive","text":"","code":"download_archive(   archive_timestamp,   provider,   dataset,   local_dir = NULL,   gcs_bucket = \"calcofi-files-public\",   archive_prefix = \"archive\" )"},{"path":"https://calcofi.io/calcofi4db/reference/download_archive.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Download archive to local directory — download_archive","text":"archive_timestamp Archive timestamp provider Data provider dataset Dataset name local_dir Local directory download (default: temp directory) gcs_bucket GCS bucket name archive_prefix Archive folder prefix","code":""},{"path":"https://calcofi.io/calcofi4db/reference/download_archive.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Download archive to local directory — download_archive","text":"Path local directory containing downloaded files","code":""},{"path":"https://calcofi.io/calcofi4db/reference/download_archive.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Download archive to local directory — download_archive","text":"","code":"if (FALSE) { # \\dontrun{ local_dir <- download_archive(   archive_timestamp = \"2026-02-02_121557\",   provider = \"swfsc.noaa.gov\",   dataset = \"calcofi-db\") } # }"},{"path":"https://calcofi.io/calcofi4db/reference/duckdb_to_parquet.html","id":null,"dir":"Reference","previous_headings":"","what":"Export DuckDB table to Parquet — duckdb_to_parquet","title":"Export DuckDB table to Parquet — duckdb_to_parquet","text":"Exports DuckDB table query result Parquet file.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/duckdb_to_parquet.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Export DuckDB table to Parquet — duckdb_to_parquet","text":"","code":"duckdb_to_parquet(con, table_or_query, output, compression = \"snappy\")"},{"path":"https://calcofi.io/calcofi4db/reference/duckdb_to_parquet.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Export DuckDB table to Parquet — duckdb_to_parquet","text":"con DuckDB connection table_or_query Table name SQL query output Path output Parquet file compression Compression codec (default: \"snappy\")","code":""},{"path":"https://calcofi.io/calcofi4db/reference/duckdb_to_parquet.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Export DuckDB table to Parquet — duckdb_to_parquet","text":"Path created Parquet file","code":""},{"path":"https://calcofi.io/calcofi4db/reference/duckdb_to_parquet.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Export DuckDB table to Parquet — duckdb_to_parquet","text":"","code":"if (FALSE) { # \\dontrun{ # export table duckdb_to_parquet(con, \"bottle\", \"export/bottle.parquet\")  # export query result duckdb_to_parquet(   con,   \"SELECT * FROM bottle WHERE year >= 2020\",   \"export/bottle_recent.parquet\") } # }"},{"path":"https://calcofi.io/calcofi4db/reference/flag_invalid_rows.html","id":null,"dir":"Reference","previous_headings":"","what":"Flag and Export Invalid Rows — flag_invalid_rows","title":"Flag and Export Invalid Rows — flag_invalid_rows","text":"Writes invalid rows CSV file manual review. Creates output directory exist. Returns path created file.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/flag_invalid_rows.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Flag and Export Invalid Rows — flag_invalid_rows","text":"","code":"flag_invalid_rows(invalid_rows, output_path, description, append = FALSE)"},{"path":"https://calcofi.io/calcofi4db/reference/flag_invalid_rows.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Flag and Export Invalid Rows — flag_invalid_rows","text":"invalid_rows Tibble invalid rows export output_path Path output CSV file description Description validation failure (logging) append TRUE, append existing file; FALSE (default), overwrite","code":""},{"path":"https://calcofi.io/calcofi4db/reference/flag_invalid_rows.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Flag and Export Invalid Rows — flag_invalid_rows","text":"Path created/updated CSV file, NULL rows flag","code":""},{"path":"https://calcofi.io/calcofi4db/reference/flag_invalid_rows.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Flag and Export Invalid Rows — flag_invalid_rows","text":"","code":"if (FALSE) { # \\dontrun{ orphan_species <- validate_fk_references(con, \"ichthyo\", \"species_id\", \"species\", \"species_id\") if (nrow(orphan_species) > 0) {   flag_invalid_rows(     invalid_rows = orphan_species,     output_path  = \"data/flagged/orphan_species.csv\",     description  = \"Species IDs not found in species table\") } } # }"},{"path":"https://calcofi.io/calcofi4db/reference/freeze_release.html","id":null,"dir":"Reference","previous_headings":"","what":"Freeze a release of the DuckLake — freeze_release","title":"Freeze a release of the DuckLake — freeze_release","text":"Creates immutable frozen release current Working DuckLake state. Strips provenance columns, exports tables Parquet, creates catalog, uploads gs://calcofi-db/ducklake/releases/{version}/.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/freeze_release.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Freeze a release of the DuckLake — freeze_release","text":"","code":"freeze_release(   con,   version,   release_notes = NULL,   validate = TRUE,   tables = NULL,   dry_run = FALSE,   bucket = \"calcofi-db\" )"},{"path":"https://calcofi.io/calcofi4db/reference/freeze_release.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Freeze a release of the DuckLake — freeze_release","text":"con DuckDB connection get_working_ducklake() version Version string format \"vYYYY.MM\" (e.g., \"v2026.02\") release_notes Character string release notes, path markdown file validate Run validation checks freezing (default: TRUE) tables Character vector tables include (default: non-system tables) dry_run TRUE, simulate without uploading (default: FALSE) bucket GCS bucket name (default: \"calcofi-db\")","code":""},{"path":"https://calcofi.io/calcofi4db/reference/freeze_release.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Freeze a release of the DuckLake — freeze_release","text":"List : version: version string gcs_path: GCS path release tables: Tibble table names row counts parquet_files: Paths created Parquet files","code":""},{"path":"https://calcofi.io/calcofi4db/reference/freeze_release.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Freeze a release of the DuckLake — freeze_release","text":"","code":"if (FALSE) { # \\dontrun{ con <- get_working_ducklake() result <- freeze_release(   con           = con,   version       = \"v2026.02\",   release_notes = \"First release with bottle and larvae data.\") } # }"},{"path":"https://calcofi.io/calcofi4db/reference/get_archive_manifest.html","id":null,"dir":"Reference","previous_headings":"","what":"Get archive manifest (file metadata) — get_archive_manifest","title":"Get archive manifest (file metadata) — get_archive_manifest","text":"Retrieves metadata (size, path) files GCS archive.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/get_archive_manifest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get archive manifest (file metadata) — get_archive_manifest","text":"","code":"get_archive_manifest(   archive_timestamp,   provider,   dataset,   gcs_bucket = \"calcofi-files-public\",   archive_prefix = \"archive\" )"},{"path":"https://calcofi.io/calcofi4db/reference/get_archive_manifest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get archive manifest (file metadata) — get_archive_manifest","text":"archive_timestamp Archive timestamp (e.g., \"2026-02-02_121557\") provider Data provider (e.g., \"swfsc.noaa.gov\") dataset Dataset name (e.g., \"calcofi-db\") gcs_bucket GCS bucket name archive_prefix Archive folder prefix","code":""},{"path":"https://calcofi.io/calcofi4db/reference/get_archive_manifest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get archive manifest (file metadata) — get_archive_manifest","text":"Tibble columns: name, size, gcs_path","code":""},{"path":"https://calcofi.io/calcofi4db/reference/get_archive_manifest.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get archive manifest (file metadata) — get_archive_manifest","text":"","code":"if (FALSE) { # \\dontrun{ manifest <- get_archive_manifest(   archive_timestamp = \"2026-02-02_121557\",   provider = \"swfsc.noaa.gov\",   dataset = \"calcofi-db\") } # }"},{"path":"https://calcofi.io/calcofi4db/reference/get_calcofi_file.html","id":null,"dir":"Reference","previous_headings":"","what":"Get a CalCOFI file from the immutable archive — get_calcofi_file","title":"Get a CalCOFI file from the immutable archive — get_calcofi_file","text":"Downloads file immutable archive snapshot. ensures reproducible data access referencing specific archive timestamps.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/get_calcofi_file.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get a CalCOFI file from the immutable archive — get_calcofi_file","text":"","code":"get_calcofi_file(path, date = \"latest\", bucket = \"public\", local_path = NULL)"},{"path":"https://calcofi.io/calcofi4db/reference/get_calcofi_file.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get a CalCOFI file from the immutable archive — get_calcofi_file","text":"path Relative path within archive (e.g., \"swfsc.noaa.gov/calcofi-db/cruise.csv\") date Date string format \"YYYY-MM-DD_HHMMSS\" \"latest\" (default) bucket Bucket type: \"public\" \"private\" (default: \"public\") local_path Local path save file (default: temp file)","code":""},{"path":"https://calcofi.io/calcofi4db/reference/get_calcofi_file.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get a CalCOFI file from the immutable archive — get_calcofi_file","text":"Path downloaded local file","code":""},{"path":"https://calcofi.io/calcofi4db/reference/get_calcofi_file.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get a CalCOFI file from the immutable archive — get_calcofi_file","text":"","code":"if (FALSE) { # \\dontrun{ # get latest version cruise_csv <- get_calcofi_file(\"swfsc.noaa.gov/calcofi-db/cruise.csv\")  # get specific version for reproducibility cruise_csv <- get_calcofi_file(   \"swfsc.noaa.gov/calcofi-db/cruise.csv\",   date = \"2026-02-01_143059\") } # }"},{"path":"https://calcofi.io/calcofi4db/reference/get_db_con.html","id":null,"dir":"Reference","previous_headings":"","what":"Get a database connection to the CalCOFI PostgreSQL database (DEPRECATED) — get_db_con","title":"Get a database connection to the CalCOFI PostgreSQL database (DEPRECATED) — get_db_con","text":"function deprecated. Please use one following alternatives: get_working_ducklake: admin/ingest work Working DuckLake get_duckdb_con: DuckDB connections frozen releases calcofi4r::cc_get_db: end-users accessing frozen CalCOFI data","code":""},{"path":"https://calcofi.io/calcofi4db/reference/get_db_con.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get a database connection to the CalCOFI PostgreSQL database (DEPRECATED) — get_db_con","text":"","code":"get_db_con(   schemas = \"public\",   host = NULL,   port = 5432,   dbname = \"gis\",   user = \"admin\",   password_file = NULL )"},{"path":"https://calcofi.io/calcofi4db/reference/get_db_con.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get a database connection to the CalCOFI PostgreSQL database (DEPRECATED) — get_db_con","text":"schemas Character vector schema search paths (default: \"public\") host Database host (default: automatically detected based system) port Database port (default: 5432) dbname Database name (default: \"gis\") user Database user (default: \"admin\") password_file Path file containing database password (default: system-dependent location)","code":""},{"path":"https://calcofi.io/calcofi4db/reference/get_db_con.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get a database connection to the CalCOFI PostgreSQL database (DEPRECATED) — get_db_con","text":"database connection object","code":""},{"path":"https://calcofi.io/calcofi4db/reference/get_duckdb_con.html","id":null,"dir":"Reference","previous_headings":"","what":"Get a DuckDB connection — get_duckdb_con","title":"Get a DuckDB connection — get_duckdb_con","text":"Creates connection DuckDB database, either local file -memory. Optionally downloads GCS path starts gs://.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/get_duckdb_con.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get a DuckDB connection — get_duckdb_con","text":"","code":"get_duckdb_con(path = \":memory:\", read_only = FALSE, config = list())"},{"path":"https://calcofi.io/calcofi4db/reference/get_duckdb_con.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get a DuckDB connection — get_duckdb_con","text":"path Path DuckDB file, GCS path, \":memory:\" -memory read_only Open database read-mode (default: FALSE) config Named list DuckDB configuration options (default: empty list)","code":""},{"path":"https://calcofi.io/calcofi4db/reference/get_duckdb_con.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get a DuckDB connection — get_duckdb_con","text":"DuckDB connection object","code":""},{"path":"https://calcofi.io/calcofi4db/reference/get_duckdb_con.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get a DuckDB connection — get_duckdb_con","text":"","code":"if (FALSE) { # \\dontrun{ # in-memory database con <- get_duckdb_con()  # local file con <- get_duckdb_con(\"data/calcofi.duckdb\")  # from GCS (downloads first) con <- get_duckdb_con(\"gs://calcofi-db/duckdb/calcofi.duckdb\")  # read-only with custom config con <- get_duckdb_con(   \"calcofi.duckdb\",   read_only = TRUE,   config = list(threads = 4)) } # }"},{"path":"https://calcofi.io/calcofi4db/reference/get_duckdb_tables.html","id":null,"dir":"Reference","previous_headings":"","what":"Get table information from DuckDB — get_duckdb_tables","title":"Get table information from DuckDB — get_duckdb_tables","text":"Retrieves schema information tables DuckDB database.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/get_duckdb_tables.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get table information from DuckDB — get_duckdb_tables","text":"","code":"get_duckdb_tables(con)"},{"path":"https://calcofi.io/calcofi4db/reference/get_duckdb_tables.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get table information from DuckDB — get_duckdb_tables","text":"con DuckDB connection","code":""},{"path":"https://calcofi.io/calcofi4db/reference/get_duckdb_tables.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get table information from DuckDB — get_duckdb_tables","text":"Data frame table names, column info, row counts","code":""},{"path":"https://calcofi.io/calcofi4db/reference/get_duckdb_tables.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get table information from DuckDB — get_duckdb_tables","text":"","code":"if (FALSE) { # \\dontrun{ tables <- get_duckdb_tables(con) tables } # }"},{"path":"https://calcofi.io/calcofi4db/reference/get_gcs_file.html","id":null,"dir":"Reference","previous_headings":"","what":"Get a file from Google Cloud Storage — get_gcs_file","title":"Get a file from Google Cloud Storage — get_gcs_file","text":"Downloads file GCS local path, using googleCloudStorageR gcloud CLI fallback.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/get_gcs_file.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get a file from Google Cloud Storage — get_gcs_file","text":"","code":"get_gcs_file(gcs_path, bucket = NULL, local_path = NULL, overwrite = FALSE)"},{"path":"https://calcofi.io/calcofi4db/reference/get_gcs_file.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get a file from Google Cloud Storage — get_gcs_file","text":"gcs_path Full GCS path (gs://bucket/path//file) relative path bucket GCS bucket name (used gcs_path relative) local_path Local path save file. NULL, returns temp file path overwrite Whether overwrite existing local file (default: FALSE)","code":""},{"path":"https://calcofi.io/calcofi4db/reference/get_gcs_file.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get a file from Google Cloud Storage — get_gcs_file","text":"Path downloaded local file","code":""},{"path":"https://calcofi.io/calcofi4db/reference/get_gcs_file.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get a file from Google Cloud Storage — get_gcs_file","text":"","code":"if (FALSE) { # \\dontrun{ # using full gs:// path local_file <- get_gcs_file(\"gs://calcofi-files/current/bottle.csv\")  # using bucket + relative path local_file <- get_gcs_file(   \"current/calcofi.org/bottle-database/bottle.csv\",   bucket = \"calcofi-files-public\") } # }"},{"path":"https://calcofi.io/calcofi4db/reference/get_historical_file.html","id":null,"dir":"Reference","previous_headings":"","what":"Get historical file from a specific date — get_historical_file","title":"Get historical file from a specific date — get_historical_file","text":"Retrieves file existed specific date archive.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/get_historical_file.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get historical file from a specific date — get_historical_file","text":"","code":"get_historical_file(path, date, bucket = \"calcofi-files\", local_path = NULL)"},{"path":"https://calcofi.io/calcofi4db/reference/get_historical_file.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get historical file from a specific date — get_historical_file","text":"path Relative path file date Date retrieve (character \"YYYY-MM-DD\" Date object) bucket GCS bucket name (default: \"calcofi-files\") local_path Local path save file (default: temp file)","code":""},{"path":"https://calcofi.io/calcofi4db/reference/get_historical_file.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get historical file from a specific date — get_historical_file","text":"Path downloaded local file","code":""},{"path":"https://calcofi.io/calcofi4db/reference/get_historical_file.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get historical file from a specific date — get_historical_file","text":"","code":"if (FALSE) { # \\dontrun{ # get bottle.csv as it was on 2026-01-15 file <- get_historical_file(   \"calcofi.org/bottle-database/bottle.csv\",   date = \"2026-01-15\") } # }"},{"path":"https://calcofi.io/calcofi4db/reference/get_latest_archive_timestamp.html","id":null,"dir":"Reference","previous_headings":"","what":"Get latest archive timestamp from GCS — get_latest_archive_timestamp","title":"Get latest archive timestamp from GCS — get_latest_archive_timestamp","text":"Finds recent archive timestamp GCS bucket.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/get_latest_archive_timestamp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get latest archive timestamp from GCS — get_latest_archive_timestamp","text":"","code":"get_latest_archive_timestamp(   gcs_bucket = \"calcofi-files-public\",   archive_prefix = \"archive\" )"},{"path":"https://calcofi.io/calcofi4db/reference/get_latest_archive_timestamp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get latest archive timestamp from GCS — get_latest_archive_timestamp","text":"gcs_bucket GCS bucket name (default: \"calcofi-files-public\") archive_prefix Prefix archive folder (default: \"archive\")","code":""},{"path":"https://calcofi.io/calcofi4db/reference/get_latest_archive_timestamp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get latest archive timestamp from GCS — get_latest_archive_timestamp","text":"Character string latest timestamp, NULL archives exist","code":""},{"path":"https://calcofi.io/calcofi4db/reference/get_latest_archive_timestamp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get latest archive timestamp from GCS — get_latest_archive_timestamp","text":"","code":"if (FALSE) { # \\dontrun{ latest <- get_latest_archive_timestamp() # \"2026-02-02_121557\" } # }"},{"path":"https://calcofi.io/calcofi4db/reference/get_local_manifest.html","id":null,"dir":"Reference","previous_headings":"","what":"Get local file manifest — get_local_manifest","title":"Get local file manifest — get_local_manifest","text":"Retrieves metadata (size, path) CSV files local directory.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/get_local_manifest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get local file manifest — get_local_manifest","text":"","code":"get_local_manifest(dir_csv)"},{"path":"https://calcofi.io/calcofi4db/reference/get_local_manifest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get local file manifest — get_local_manifest","text":"dir_csv Local directory containing CSV files","code":""},{"path":"https://calcofi.io/calcofi4db/reference/get_local_manifest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get local file manifest — get_local_manifest","text":"Tibble columns: name, size, local_path","code":""},{"path":"https://calcofi.io/calcofi4db/reference/get_local_manifest.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get local file manifest — get_local_manifest","text":"","code":"if (FALSE) { # \\dontrun{ manifest <- get_local_manifest(\"/path/to/csv/files\") } # }"},{"path":"https://calcofi.io/calcofi4db/reference/get_manifest.html","id":null,"dir":"Reference","previous_headings":"","what":"Get manifest for a specific date — get_manifest","title":"Get manifest for a specific date — get_manifest","text":"Retrieves manifest JSON GCS given sync timestamp. manifest contains metadata files archive snapshot.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/get_manifest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get manifest for a specific date — get_manifest","text":"","code":"get_manifest(date = \"latest\", bucket = \"public\")"},{"path":"https://calcofi.io/calcofi4db/reference/get_manifest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get manifest for a specific date — get_manifest","text":"date Date string format \"YYYY-MM-DD_HHMMSS\" \"latest\" (default) bucket Bucket type: \"public\" \"private\" (default: \"public\")","code":""},{"path":"https://calcofi.io/calcofi4db/reference/get_manifest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get manifest for a specific date — get_manifest","text":"List containing manifest data (generated_at, sync_timestamp, archive_path, files)","code":""},{"path":"https://calcofi.io/calcofi4db/reference/get_manifest.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get manifest for a specific date — get_manifest","text":"","code":"if (FALSE) { # \\dontrun{ manifest <- get_manifest() manifest <- get_manifest(\"2026-02-01_143059\", \"public\") } # }"},{"path":"https://calcofi.io/calcofi4db/reference/get_package_version.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Current Package Version — get_package_version","title":"Get Current Package Version — get_package_version","text":"Reads current version DESCRIPTION file.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/get_package_version.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Current Package Version — get_package_version","text":"","code":"get_package_version()"},{"path":"https://calcofi.io/calcofi4db/reference/get_package_version.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Current Package Version — get_package_version","text":"Character string current version","code":""},{"path":"https://calcofi.io/calcofi4db/reference/get_package_version.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get Current Package Version — get_package_version","text":"","code":"if (FALSE) { # \\dontrun{ current_version <- get_package_version() print(current_version) } # }"},{"path":"https://calcofi.io/calcofi4db/reference/get_parquet_metadata.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Parquet file metadata — get_parquet_metadata","title":"Get Parquet file metadata — get_parquet_metadata","text":"Retrieves schema metadata Parquet file.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/get_parquet_metadata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Parquet file metadata — get_parquet_metadata","text":"","code":"get_parquet_metadata(path)"},{"path":"https://calcofi.io/calcofi4db/reference/get_parquet_metadata.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Parquet file metadata — get_parquet_metadata","text":"path Path Parquet file","code":""},{"path":"https://calcofi.io/calcofi4db/reference/get_parquet_metadata.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Parquet file metadata — get_parquet_metadata","text":"List schema, num_rows, num_columns, file_size","code":""},{"path":"https://calcofi.io/calcofi4db/reference/get_parquet_metadata.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get Parquet file metadata — get_parquet_metadata","text":"","code":"if (FALSE) { # \\dontrun{ meta <- get_parquet_metadata(\"parquet/bottle.parquet\") meta$schema meta$num_rows } # }"},{"path":"https://calcofi.io/calcofi4db/reference/get_release_metadata.html","id":null,"dir":"Reference","previous_headings":"","what":"Get metadata for a frozen release — get_release_metadata","title":"Get metadata for a frozen release — get_release_metadata","text":"Retrieves detailed metadata specific frozen DuckLake release including version info, table schemas, statistics.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/get_release_metadata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get metadata for a frozen release — get_release_metadata","text":"","code":"get_release_metadata(version = \"latest\", bucket = \"calcofi-db\")"},{"path":"https://calcofi.io/calcofi4db/reference/get_release_metadata.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get metadata for a frozen release — get_release_metadata","text":"version Version string (e.g., \"v2026.02\") \"latest\" (default) bucket GCS bucket name (default: \"calcofi-db\")","code":""},{"path":"https://calcofi.io/calcofi4db/reference/get_release_metadata.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get metadata for a frozen release — get_release_metadata","text":"List : version: Version string release_date: Release timestamp release_notes: Release notes (character) tables: Tibble table metadata (name, rows, columns, size_bytes) gcs_path: GCS path release files","code":""},{"path":"https://calcofi.io/calcofi4db/reference/get_release_metadata.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get metadata for a frozen release — get_release_metadata","text":"","code":"if (FALSE) { # \\dontrun{ meta <- get_release_metadata() meta <- get_release_metadata(\"v2026.02\") meta$tables } # }"},{"path":"https://calcofi.io/calcofi4db/reference/get_schema_versions.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Schema Version History — get_schema_versions","title":"Get Schema Version History — get_schema_versions","text":"Retrieves schema version history either database CSV file.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/get_schema_versions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Schema Version History — get_schema_versions","text":"","code":"get_schema_versions(con = NULL, schema = \"dev\", from_csv = FALSE)"},{"path":"https://calcofi.io/calcofi4db/reference/get_schema_versions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Schema Version History — get_schema_versions","text":"con Database connection object (optional from_csv = TRUE) schema Schema name (default: \"dev\") from_csv Logical, read CSV file instead database (default: FALSE)","code":""},{"path":"https://calcofi.io/calcofi4db/reference/get_schema_versions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Schema Version History — get_schema_versions","text":"tibble version history","code":""},{"path":"https://calcofi.io/calcofi4db/reference/get_schema_versions.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get Schema Version History — get_schema_versions","text":"","code":"if (FALSE) { # \\dontrun{ # Get from database get_schema_versions(con, schema = \"dev\")  # Get from CSV file get_schema_versions(from_csv = TRUE) } # }"},{"path":"https://calcofi.io/calcofi4db/reference/get_working_ducklake.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Working DuckLake connection — get_working_ducklake","title":"Get Working DuckLake connection — get_working_ducklake","text":"Connects internal Working DuckLake database used ingestion workflows. database includes full provenance tracking columns (_source_file, _source_row, _source_uuid, _ingested_at).","code":""},{"path":"https://calcofi.io/calcofi4db/reference/get_working_ducklake.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Working DuckLake connection — get_working_ducklake","text":"","code":"get_working_ducklake(   local_path = NULL,   read_only = FALSE,   refresh = FALSE,   gcs_path = \"gs://calcofi-db/ducklake/working/calcofi.duckdb\" )"},{"path":"https://calcofi.io/calcofi4db/reference/get_working_ducklake.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Working DuckLake connection — get_working_ducklake","text":"local_path Path local DuckDB file caching. NULL, uses temp directory path derived GCS location. read_only Open read-mode (default: FALSE) refresh Force re-download GCS even local cache exists (default: FALSE) gcs_path GCS path Working DuckLake (default: \"gs://calcofi-db/ducklake/working/calcofi.duckdb\")","code":""},{"path":"https://calcofi.io/calcofi4db/reference/get_working_ducklake.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Working DuckLake connection — get_working_ducklake","text":"DuckDB connection object","code":""},{"path":"https://calcofi.io/calcofi4db/reference/get_working_ducklake.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get Working DuckLake connection — get_working_ducklake","text":"Working DuckLake stored gs://calcofi-db/ducklake/working/. includes provenance columns supports time travel queries via DuckLake. read-access stable data, use cc_get_db() calcofi4r package access frozen releases instead.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/get_working_ducklake.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get Working DuckLake connection — get_working_ducklake","text":"","code":"if (FALSE) { # \\dontrun{ con <- get_working_ducklake() DBI::dbListTables(con)  # read-only access con <- get_working_ducklake(read_only = TRUE) } # }"},{"path":"https://calcofi.io/calcofi4db/reference/github_file_link.html","id":null,"dir":"Reference","previous_headings":"","what":"Create GitHub File Link — github_file_link","title":"Create GitHub File Link — github_file_link","text":"Converts local file path GitHub repository link. Extracts relative path workflows directory creates HTML anchor tag.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/github_file_link.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create GitHub File Link — github_file_link","text":"","code":"github_file_link(   file_path,   repo = \"CalCOFI/workflows\",   branch = \"main\",   base_dir = \"workflows\" )"},{"path":"https://calcofi.io/calcofi4db/reference/github_file_link.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create GitHub File Link — github_file_link","text":"file_path Local file path (can full path relative) repo GitHub repository format \"owner/repo\" (default: \"CalCOFI/workflows\") branch Git branch (default: \"main\") base_dir Base directory extract relative path (default: \"workflows\")","code":""},{"path":"https://calcofi.io/calcofi4db/reference/github_file_link.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create GitHub File Link — github_file_link","text":"HTML anchor tag string linking GitHub file","code":""},{"path":"https://calcofi.io/calcofi4db/reference/github_file_link.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create GitHub File Link — github_file_link","text":"","code":"if (FALSE) { # \\dontrun{ github_file_link(\"/Users/bbest/Github/CalCOFI/workflows/data/flagged/orphan_species.csv\") # Returns: \"<a href='https://github.com/CalCOFI/workflows/blob/main/data/flagged/orphan_species.csv'> #           calcofi/workflows: data/flagged/orphan_species.csv<\/a>\" } # }"},{"path":"https://calcofi.io/calcofi4db/reference/ingest_csv_to_db.html","id":null,"dir":"Reference","previous_headings":"","what":"Ingest CSV data to PostgreSQL database (DEPRECATED) — ingest_csv_to_db","title":"Ingest CSV data to PostgreSQL database (DEPRECATED) — ingest_csv_to_db","text":"function deprecated. Please use ingest_to_working instead ingesting data DuckLake database automatic provenance tracking. Loads transformed data PostgreSQL database proper metadata.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/ingest_csv_to_db.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ingest CSV data to PostgreSQL database (DEPRECATED) — ingest_csv_to_db","text":"","code":"ingest_csv_to_db(   con,   schema,   transformed_data,   d_flds_rd,   d_gdir_data = NULL,   workflow_info,   overwrite = FALSE )"},{"path":"https://calcofi.io/calcofi4db/reference/ingest_csv_to_db.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Ingest CSV data to PostgreSQL database (DEPRECATED) — ingest_csv_to_db","text":"con Database connection schema Database schema transformed_data Transformed data transform_data() d_flds_rd Field redefinition data frame d_gdir_data Google Drive metadata (optional) workflow_info Workflow information (name, URL, etc.) overwrite Whether overwrite existing tables","code":""},{"path":"https://calcofi.io/calcofi4db/reference/ingest_csv_to_db.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Ingest CSV data to PostgreSQL database (DEPRECATED) — ingest_csv_to_db","text":"Data frame ingestion statistics","code":""},{"path":"https://calcofi.io/calcofi4db/reference/ingest_csv_to_db.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Ingest CSV data to PostgreSQL database (DEPRECATED) — ingest_csv_to_db","text":"","code":"if (FALSE) { # \\dontrun{ stats <- ingest_csv_to_db(   con = db_connection,   schema = \"public\",   transformed_data = transformed_data,   d_flds_rd = data_info$d_flds_rd,   d_gdir_data = data_info$d_gdir_data,   workflow_info = data_info$workflow_info ) } # }"},{"path":"https://calcofi.io/calcofi4db/reference/ingest_dataset.html","id":null,"dir":"Reference","previous_headings":"","what":"Ingest Dataset into Working DuckLake — ingest_dataset","title":"Ingest Dataset into Working DuckLake — ingest_dataset","text":"High-level function ingest tables dataset Working DuckLake. wraps transform_data() ingest_to_working() single operation proper provenance tracking.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/ingest_dataset.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ingest Dataset into Working DuckLake — ingest_dataset","text":"","code":"ingest_dataset(con, d, mode = \"replace\", verbose = TRUE)"},{"path":"https://calcofi.io/calcofi4db/reference/ingest_dataset.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Ingest Dataset into Working DuckLake — ingest_dataset","text":"con DuckDB connection get_working_ducklake() d Data object read_csv_files() mode Insert mode: \"replace\" (default) \"append\" verbose Print progress messages (default: TRUE)","code":""},{"path":"https://calcofi.io/calcofi4db/reference/ingest_dataset.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Ingest Dataset into Working DuckLake — ingest_dataset","text":"Tibble ingestion statistics table: tbl: Original table name tbl_new: New table name redefinition gcs_path: Source file path provenance rows_input: Number rows ingested rows_after: Total rows table ingestion ingested_at: Timestamp ingestion","code":""},{"path":"https://calcofi.io/calcofi4db/reference/ingest_dataset.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Ingest Dataset into Working DuckLake — ingest_dataset","text":"","code":"if (FALSE) { # \\dontrun{ # read and ingest dataset d <- read_csv_files(   provider     = \"swfsc.noaa.gov\",   dataset      = \"calcofi-db\",   dir_data     = \"~/My Drive/projects/calcofi/data-public\",   metadata_dir = \"metadata\")  con <- get_working_ducklake() stats <- ingest_dataset(con, d, mode = \"replace\") save_working_ducklake(con) close_duckdb(con) } # }"},{"path":"https://calcofi.io/calcofi4db/reference/ingest_dataset_pg.html","id":null,"dir":"Reference","previous_headings":"","what":"Ingest a Dataset to PostgreSQL (DEPRECATED) — ingest_dataset_pg","title":"Ingest a Dataset to PostgreSQL (DEPRECATED) — ingest_dataset_pg","text":"function deprecated. Please use ingest_dataset R/ducklake.R DuckLake workflows, targets pipeline ingest_to_working instead. Legacy function ingest dataset PostgreSQL database.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/ingest_dataset_pg.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ingest a Dataset to PostgreSQL (DEPRECATED) — ingest_dataset_pg","text":"","code":"ingest_dataset_pg(   con,   provider,   dataset,   dir_data,   schema = \"public\",   url_gdata = NULL,   email = NULL,   overwrite = FALSE )"},{"path":"https://calcofi.io/calcofi4db/reference/ingest_dataset_pg.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Ingest a Dataset to PostgreSQL (DEPRECATED) — ingest_dataset_pg","text":"con Database connection provider Data provider name dataset Dataset name dir_data Base directory data schema Database schema url_gdata Google Drive folder URL (optional) email Google Drive authentication email (optional) overwrite Whether overwrite existing tables","code":""},{"path":"https://calcofi.io/calcofi4db/reference/ingest_dataset_pg.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Ingest a Dataset to PostgreSQL (DEPRECATED) — ingest_dataset_pg","text":"List ingestion results statistics","code":""},{"path":"https://calcofi.io/calcofi4db/reference/ingest_dataset_pg.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Ingest a Dataset to PostgreSQL (DEPRECATED) — ingest_dataset_pg","text":"","code":"if (FALSE) { # \\dontrun{ result <- ingest_dataset_pg(   con = db_connection,   provider = \"swfsc.noaa.gov\",   dataset = \"calcofi-db\",   dir_data = \"/path/to/data\",   schema = \"public\" ) } # }"},{"path":"https://calcofi.io/calcofi4db/reference/ingest_to_working.html","id":null,"dir":"Reference","previous_headings":"","what":"Ingest data to Working DuckLake — ingest_to_working","title":"Ingest data to Working DuckLake — ingest_to_working","text":"Ingests data frame Working DuckLake automatic provenance tracking. Adds _source_file, _source_row, _source_uuid, _ingested_at columns track data lineage.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/ingest_to_working.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ingest data to Working DuckLake — ingest_to_working","text":"","code":"ingest_to_working(   con,   data,   table,   source_file,   source_uuid_col = NULL,   source_row_start = 1,   mode = \"append\",   upsert_keys = NULL )"},{"path":"https://calcofi.io/calcofi4db/reference/ingest_to_working.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Ingest data to Working DuckLake — ingest_to_working","text":"con DuckDB connection get_working_ducklake() data Data frame ingest table Target table name source_file Path original CSV file Archive (provenance). full path including archive timestamp (e.g., \"archive/2026-02-02_121557/swfsc.noaa.gov/calcofi-db/larva.csv\") source_uuid_col Column name containing original UUIDs (optional). provided, values stored _source_uuid tracing back source records. source_row_start Starting row number source file (default: 1) mode Insert mode: \"append\", \"replace\", \"upsert\" (default: \"append\") append: Add rows existing table replace: Drop recreate table upsert: Update existing rows, insert new rows (requires upsert_keys) upsert_keys Character vector column names use keys upsert mode","code":""},{"path":"https://calcofi.io/calcofi4db/reference/ingest_to_working.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Ingest data to Working DuckLake — ingest_to_working","text":"Tibble ingestion statistics: table: Table name mode: Insert mode used rows_input: Number rows input data rows_after: Number rows table ingestion ingested_at: Timestamp ingestion","code":""},{"path":"https://calcofi.io/calcofi4db/reference/ingest_to_working.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Ingest data to Working DuckLake — ingest_to_working","text":"","code":"if (FALSE) { # \\dontrun{ con <- get_working_ducklake()  larvae_data <- readr::read_csv(\"larvae.csv\") stats <- ingest_to_working(   con         = con,   data        = larvae_data,   table       = \"larva\",   source_file = \"archive/2026-02-02_121557/swfsc.noaa.gov/calcofi-db/larva.csv\",   source_uuid_col = \"larva_uuid\",   mode        = \"replace\")  # append new data new_data <- readr::read_csv(\"larvae_update.csv\") stats <- ingest_to_working(   con         = con,   data        = new_data,   table       = \"larva\",   source_file = \"archive/2026-03-01_121557/swfsc.noaa.gov/calcofi-db/larva.csv\",   mode        = \"append\") } # }"},{"path":"https://calcofi.io/calcofi4db/reference/init_schema_version_csv.html","id":null,"dir":"Reference","previous_headings":"","what":"Initialize Schema Version CSV — init_schema_version_csv","title":"Initialize Schema Version CSV — init_schema_version_csv","text":"Creates empty schema_version.csv file inst/ directory exist. useful starting new versioning system.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/init_schema_version_csv.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Initialize Schema Version CSV — init_schema_version_csv","text":"","code":"init_schema_version_csv()"},{"path":"https://calcofi.io/calcofi4db/reference/init_schema_version_csv.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Initialize Schema Version CSV — init_schema_version_csv","text":"Invisible NULL (CSV file created)","code":""},{"path":"https://calcofi.io/calcofi4db/reference/init_schema_version_csv.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Initialize Schema Version CSV — init_schema_version_csv","text":"","code":"if (FALSE) { # \\dontrun{ init_schema_version_csv() } # }"},{"path":"https://calcofi.io/calcofi4db/reference/integrate_to_working_ducklake.html","id":null,"dir":"Reference","previous_headings":"","what":"Integrate Ingest Outputs into Working DuckLake — integrate_to_working_ducklake","title":"Integrate Ingest Outputs into Working DuckLake — integrate_to_working_ducklake","text":"Reads parquet files multiple ingest outputs integrates Working DuckLake. Tables different ingests name combined (e.g., cruise tables different sources). Provenance columns (_ingest_provider, _ingest_dataset) added track origin.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/integrate_to_working_ducklake.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Integrate Ingest Outputs into Working DuckLake — integrate_to_working_ducklake","text":"","code":"integrate_to_working_ducklake(   ingests,   gcs_bucket = \"calcofi-db\",   ducklake_path = \"ducklake/working\" )"},{"path":"https://calcofi.io/calcofi4db/reference/integrate_to_working_ducklake.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Integrate Ingest Outputs into Working DuckLake — integrate_to_working_ducklake","text":"ingests List ingest result lists (write_ingest_outputs()) tibble list_ingest_outputs() gcs_bucket GCS bucket (default: \"calcofi-db\") ducklake_path Path Working DuckLake within bucket (default: \"ducklake/working\")","code":""},{"path":"https://calcofi.io/calcofi4db/reference/integrate_to_working_ducklake.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Integrate Ingest Outputs into Working DuckLake — integrate_to_working_ducklake","text":"List DuckLake path table info","code":""},{"path":"https://calcofi.io/calcofi4db/reference/integrate_to_working_ducklake.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Integrate Ingest Outputs into Working DuckLake — integrate_to_working_ducklake","text":"","code":"if (FALSE) { # \\dontrun{ # from targets pipeline result <- integrate_to_working_ducklake(   ingests = list(ingest_swfsc, ingest_bottle))  # from existing GCS ingests existing <- list_ingest_outputs() result <- integrate_to_working_ducklake(existing) } # }"},{"path":"https://calcofi.io/calcofi4db/reference/list_calcofi_files.html","id":null,"dir":"Reference","previous_headings":"","what":"List CalCOFI files from manifest — list_calcofi_files","title":"List CalCOFI files from manifest — list_calcofi_files","text":"Lists files available specific archive snapshot using manifest. provides immutable, reproducible file references.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/list_calcofi_files.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"List CalCOFI files from manifest — list_calcofi_files","text":"","code":"list_calcofi_files(date = \"latest\", bucket = \"public\", path = NULL)"},{"path":"https://calcofi.io/calcofi4db/reference/list_calcofi_files.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"List CalCOFI files from manifest — list_calcofi_files","text":"date Date string format \"YYYY-MM-DD_HHMMSS\" \"latest\" (default) bucket Bucket type: \"public\" \"private\" (default: \"public\") path Optional path filter (e.g., \"swfsc.noaa.gov/calcofi-db\")","code":""},{"path":"https://calcofi.io/calcofi4db/reference/list_calcofi_files.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"List CalCOFI files from manifest — list_calcofi_files","text":"Data frame files manifest","code":""},{"path":"https://calcofi.io/calcofi4db/reference/list_calcofi_files.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"List CalCOFI files from manifest — list_calcofi_files","text":"","code":"if (FALSE) { # \\dontrun{ files <- list_calcofi_files() files <- list_calcofi_files(path = \"swfsc.noaa.gov/calcofi-db\") files <- list_calcofi_files(\"2026-02-01_143059\", \"public\") } # }"},{"path":"https://calcofi.io/calcofi4db/reference/list_frozen_releases.html","id":null,"dir":"Reference","previous_headings":"","what":"List available frozen releases — list_frozen_releases","title":"List available frozen releases — list_frozen_releases","text":"Lists available frozen DuckLake releases metadata.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/list_frozen_releases.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"List available frozen releases — list_frozen_releases","text":"","code":"list_frozen_releases(bucket = \"calcofi-db\")"},{"path":"https://calcofi.io/calcofi4db/reference/list_frozen_releases.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"List available frozen releases — list_frozen_releases","text":"bucket GCS bucket name (default: \"calcofi-db\")","code":""},{"path":"https://calcofi.io/calcofi4db/reference/list_frozen_releases.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"List available frozen releases — list_frozen_releases","text":"Tibble columns: version: Version string (e.g., \"v2026.02\") release_date: release created (POSIXct) tables: Number tables total_rows: Total row count across tables size_mb: Total size megabytes is_latest: TRUE latest release","code":""},{"path":"https://calcofi.io/calcofi4db/reference/list_frozen_releases.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"List available frozen releases — list_frozen_releases","text":"","code":"if (FALSE) { # \\dontrun{ releases <- list_frozen_releases() releases } # }"},{"path":"https://calcofi.io/calcofi4db/reference/list_gcs_files.html","id":null,"dir":"Reference","previous_headings":"","what":"List files in a GCS bucket/prefix — list_gcs_files","title":"List files in a GCS bucket/prefix — list_gcs_files","text":"Lists objects GCS bucket optional prefix filter.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/list_gcs_files.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"List files in a GCS bucket/prefix — list_gcs_files","text":"","code":"list_gcs_files(bucket, prefix = NULL, recursive = TRUE)"},{"path":"https://calcofi.io/calcofi4db/reference/list_gcs_files.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"List files in a GCS bucket/prefix — list_gcs_files","text":"bucket GCS bucket name prefix Path prefix filter results recursive Whether list recursively (default: TRUE)","code":""},{"path":"https://calcofi.io/calcofi4db/reference/list_gcs_files.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"List files in a GCS bucket/prefix — list_gcs_files","text":"Data frame columns: name, size, updated, md5Hash","code":""},{"path":"https://calcofi.io/calcofi4db/reference/list_gcs_files.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"List files in a GCS bucket/prefix — list_gcs_files","text":"","code":"if (FALSE) { # \\dontrun{ # list all files in current/ files <- list_gcs_files(\"calcofi-files\", prefix = \"current/\")  # list bottle-database files files <- list_gcs_files(   \"calcofi-files\",   prefix = \"current/calcofi.org/bottle-database/\") } # }"},{"path":"https://calcofi.io/calcofi4db/reference/list_gcs_versions.html","id":null,"dir":"Reference","previous_headings":"","what":"List versions of a file in GCS archive — list_gcs_versions","title":"List versions of a file in GCS archive — list_gcs_versions","text":"Finds archived versions file calcofi-files bucket.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/list_gcs_versions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"List versions of a file in GCS archive — list_gcs_versions","text":"","code":"list_gcs_versions(path, bucket = \"calcofi-files-public\")"},{"path":"https://calcofi.io/calcofi4db/reference/list_gcs_versions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"List versions of a file in GCS archive — list_gcs_versions","text":"path Relative path file (e.g., \"calcofi.org/bottle-database/bottle.csv\") bucket GCS bucket name (default: \"calcofi-files\")","code":""},{"path":"https://calcofi.io/calcofi4db/reference/list_gcs_versions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"List versions of a file in GCS archive — list_gcs_versions","text":"Data frame columns: version_date, gcs_path, size, updated","code":""},{"path":"https://calcofi.io/calcofi4db/reference/list_gcs_versions.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"List versions of a file in GCS archive — list_gcs_versions","text":"","code":"if (FALSE) { # \\dontrun{ versions <- list_gcs_versions(\"calcofi.org/bottle-database/bottle.csv\") } # }"},{"path":"https://calcofi.io/calcofi4db/reference/list_ingest_outputs.html","id":null,"dir":"Reference","previous_headings":"","what":"List Available Ingest Outputs — list_ingest_outputs","title":"List Available Ingest Outputs — list_ingest_outputs","text":"Lists providers datasets ingest outputs GCS.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/list_ingest_outputs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"List Available Ingest Outputs — list_ingest_outputs","text":"","code":"list_ingest_outputs(gcs_bucket = \"calcofi-db\")"},{"path":"https://calcofi.io/calcofi4db/reference/list_ingest_outputs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"List Available Ingest Outputs — list_ingest_outputs","text":"gcs_bucket GCS bucket (default: \"calcofi-db\")","code":""},{"path":"https://calcofi.io/calcofi4db/reference/list_ingest_outputs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"List Available Ingest Outputs — list_ingest_outputs","text":"Tibble provider, dataset, manifest_path columns","code":""},{"path":"https://calcofi.io/calcofi4db/reference/list_ingest_outputs.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"List Available Ingest Outputs — list_ingest_outputs","text":"","code":"if (FALSE) { # \\dontrun{ ingests <- list_ingest_outputs() } # }"},{"path":"https://calcofi.io/calcofi4db/reference/list_working_tables.html","id":null,"dir":"Reference","previous_headings":"","what":"List tables with provenance in Working DuckLake — list_working_tables","title":"List tables with provenance in Working DuckLake — list_working_tables","text":"Lists tables Working DuckLake along provenance statistics (ingestion times, source files, row counts).","code":""},{"path":"https://calcofi.io/calcofi4db/reference/list_working_tables.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"List tables with provenance in Working DuckLake — list_working_tables","text":"","code":"list_working_tables(con)"},{"path":"https://calcofi.io/calcofi4db/reference/list_working_tables.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"List tables with provenance in Working DuckLake — list_working_tables","text":"con DuckDB connection get_working_ducklake()","code":""},{"path":"https://calcofi.io/calcofi4db/reference/list_working_tables.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"List tables with provenance in Working DuckLake — list_working_tables","text":"Tibble columns: table: Table name rows: Total row count first_ingested: Earliest ingestion timestamp last_ingested: recent ingestion timestamp source_files: Number distinct source files","code":""},{"path":"https://calcofi.io/calcofi4db/reference/list_working_tables.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"List tables with provenance in Working DuckLake — list_working_tables","text":"","code":"if (FALSE) { # \\dontrun{ con <- get_working_ducklake(read_only = TRUE) tables <- list_working_tables(con) tables } # }"},{"path":"https://calcofi.io/calcofi4db/reference/load_duckdb_extension.html","id":null,"dir":"Reference","previous_headings":"","what":"Install and load DuckDB extension — load_duckdb_extension","title":"Install and load DuckDB extension — load_duckdb_extension","text":"Installs (needed) loads DuckDB extension.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/load_duckdb_extension.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Install and load DuckDB extension — load_duckdb_extension","text":"","code":"load_duckdb_extension(con, extension, from = NULL)"},{"path":"https://calcofi.io/calcofi4db/reference/load_duckdb_extension.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Install and load DuckDB extension — load_duckdb_extension","text":"con DuckDB connection extension Extension name (e.g., \"spatial\", \"h3\", \"httpfs\") Optional source (\"community\" specific URL)","code":""},{"path":"https://calcofi.io/calcofi4db/reference/load_duckdb_extension.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Install and load DuckDB extension — load_duckdb_extension","text":"connection (invisibly)","code":""},{"path":"https://calcofi.io/calcofi4db/reference/load_duckdb_extension.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Install and load DuckDB extension — load_duckdb_extension","text":"","code":"if (FALSE) { # \\dontrun{ # install community extension load_duckdb_extension(con, \"h3\", from = \"community\")  # install core extension load_duckdb_extension(con, \"spatial\") } # }"},{"path":"https://calcofi.io/calcofi4db/reference/print_csv_change_stats.html","id":null,"dir":"Reference","previous_headings":"","what":"Print CSV Change Statistics — print_csv_change_stats","title":"Print CSV Change Statistics — print_csv_change_stats","text":"Prints summary change statistics detect_csv_changes() output.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/print_csv_change_stats.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print CSV Change Statistics — print_csv_change_stats","text":"","code":"print_csv_change_stats(changes, verbose = TRUE)"},{"path":"https://calcofi.io/calcofi4db/reference/print_csv_change_stats.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print CSV Change Statistics — print_csv_change_stats","text":"changes List output detect_csv_changes() verbose Logical, whether print detailed information","code":""},{"path":"https://calcofi.io/calcofi4db/reference/print_csv_change_stats.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print CSV Change Statistics — print_csv_change_stats","text":"Invisible NULL (prints console)","code":""},{"path":"https://calcofi.io/calcofi4db/reference/print_csv_change_stats.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Print CSV Change Statistics — print_csv_change_stats","text":"","code":"if (FALSE) { # \\dontrun{ d <- read_csv_files(\"swfsc.noaa.gov\", \"calcofi-db\") changes <- detect_csv_changes(d) print_csv_change_stats(changes) } # }"},{"path":"https://calcofi.io/calcofi4db/reference/propagate_natural_key.html","id":null,"dir":"Reference","previous_headings":"","what":"Propagate Key from Parent to Child Table — propagate_natural_key","title":"Propagate Key from Parent to Child Table — propagate_natural_key","text":"Copies key column parent table child table joining common column (typically UUID). used populate foreign key columns assigning sequential IDs deterministic sort order.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/propagate_natural_key.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Propagate Key from Parent to Child Table — propagate_natural_key","text":"","code":"propagate_natural_key(   con,   child_tbl,   parent_tbl,   key_col,   join_col,   key_type = NULL )"},{"path":"https://calcofi.io/calcofi4db/reference/propagate_natural_key.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Propagate Key from Parent to Child Table — propagate_natural_key","text":"con DuckDB connection child_tbl Name child table update parent_tbl Name parent table containing key key_col Name key column propagate (e.g., \"cruise_key\", \"site_id\") join_col Name column join (must exist tables) key_type SQL data type key (\"TEXT\" \"INTEGER\", default: auto-detect parent)","code":""},{"path":"https://calcofi.io/calcofi4db/reference/propagate_natural_key.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Propagate Key from Parent to Child Table — propagate_natural_key","text":"Invisibly returns connection adding populating key column","code":""},{"path":"https://calcofi.io/calcofi4db/reference/propagate_natural_key.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Propagate Key from Parent to Child Table — propagate_natural_key","text":"","code":"if (FALSE) { # \\dontrun{ # propagate cruise_key (TEXT) to site table propagate_natural_key(   con        = con,   child_tbl  = \"site\",   parent_tbl = \"cruise\",   key_col    = \"cruise_key\",   join_col   = \"cruise_uuid\")  # propagate site_id (INTEGER) to tow table propagate_natural_key(   con        = con,   child_tbl  = \"tow\",   parent_tbl = \"site\",   key_col    = \"site_id\",   join_col   = \"site_uuid\") } # }"},{"path":"https://calcofi.io/calcofi4db/reference/put_gcs_file.html","id":null,"dir":"Reference","previous_headings":"","what":"Upload a file to Google Cloud Storage — put_gcs_file","title":"Upload a file to Google Cloud Storage — put_gcs_file","text":"Uploads local file GCS.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/put_gcs_file.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Upload a file to Google Cloud Storage — put_gcs_file","text":"","code":"put_gcs_file(local_path, gcs_path, bucket = NULL, content_type = NULL)"},{"path":"https://calcofi.io/calcofi4db/reference/put_gcs_file.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Upload a file to Google Cloud Storage — put_gcs_file","text":"local_path Path local file gcs_path Full GCS path (gs://bucket/path) relative path bucket GCS bucket name (used gcs_path relative) content_type MIME content type (default: auto-detect)","code":""},{"path":"https://calcofi.io/calcofi4db/reference/put_gcs_file.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Upload a file to Google Cloud Storage — put_gcs_file","text":"GCS URI uploaded file","code":""},{"path":"https://calcofi.io/calcofi4db/reference/put_gcs_file.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Upload a file to Google Cloud Storage — put_gcs_file","text":"","code":"if (FALSE) { # \\dontrun{ put_gcs_file(\"local/bottle.csv\", \"gs://calcofi-files/current/bottle.csv\") } # }"},{"path":"https://calcofi.io/calcofi4db/reference/query_at_time.html","id":null,"dir":"Reference","previous_headings":"","what":"Query Working DuckLake at a point in time — query_at_time","title":"Query Working DuckLake at a point in time — query_at_time","text":"Execute query Working DuckLake filtering ingestion timestamp. provides \"time travel\" capability see data existed past time.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/query_at_time.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Query Working DuckLake at a point in time — query_at_time","text":"","code":"query_at_time(con, query = NULL, timestamp, table = NULL)"},{"path":"https://calcofi.io/calcofi4db/reference/query_at_time.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Query Working DuckLake at a point in time — query_at_time","text":"con DuckDB connection get_working_ducklake() query SQL query string. query can reference _ingested_at column, function adds filter automatically. timestamp Timestamp time travel (character \"YYYY-MM-DD HH:MM:SS\" POSIXct). Filters rows _ingested_at <= timestamp. table Optional table name. provided query NULL, queries columns.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/query_at_time.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Query Working DuckLake at a point in time — query_at_time","text":"Query result tibble","code":""},{"path":"https://calcofi.io/calcofi4db/reference/query_at_time.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Query Working DuckLake at a point in time — query_at_time","text":"function provides simple time travel mechanism filtering _ingested_at provenance column. full DuckLake time travel transactional consistency, use native DuckLake catalog features.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/query_at_time.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Query Working DuckLake at a point in time — query_at_time","text":"","code":"if (FALSE) { # \\dontrun{ con <- get_working_ducklake(read_only = TRUE)  # query larva table as of january 15th old_data <- query_at_time(   con       = con,   table     = \"larva\",   timestamp = \"2026-01-15 00:00:00\")  # custom query with time filter results <- query_at_time(   con       = con,   query     = \"SELECT species_id, COUNT(*) as n FROM larva GROUP BY species_id\",   timestamp = \"2026-01-15\") } # }"},{"path":"https://calcofi.io/calcofi4db/reference/read_csv_files.html","id":null,"dir":"Reference","previous_headings":"","what":"Read CSV Files and Their Metadata — read_csv_files","title":"Read CSV Files and Their Metadata — read_csv_files","text":"Reads CSV files directory GCS archive prepares ingestion database. function primary entry point CalCOFI data ingestion workflow. performs following steps:","code":""},{"path":"https://calcofi.io/calcofi4db/reference/read_csv_files.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read CSV Files and Their Metadata — read_csv_files","text":"","code":"read_csv_files(   provider,   dataset,   subdir = NULL,   dir_data = NULL,   metadata_dir = NULL,   gcs_archive = NULL,   gcs_bucket = \"calcofi-files-public\",   archive_prefix = \"archive\",   sync_archive = TRUE,   verbose = FALSE )"},{"path":"https://calcofi.io/calcofi4db/reference/read_csv_files.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read CSV Files and Their Metadata — read_csv_files","text":"provider Data provider (e.g., \"swfsc.noaa.gov\") dataset Dataset name (e.g., \"calcofi-db\") subdir Optional subdirectory (.e., dir_data/provider/dataset/subdir) CSV files. Use datasets organized raw/ derived/ subdirectories. dir_data Directory path CalCOFI base data folder available locally, CSVs provider/dataset directory. NULL gcs_archive also NULL, error. Set NULL use gcs_archive instead. metadata_dir Directory containing redefinition metadata files (tbls_redefine.csv, flds_redefine.csv). directory structured metadata_dir/provider/dataset/. NULL, falls back legacy location calcofi4db/inst/ingest/ (deprecated). gcs_archive GCS archive path read (reproducibility). Can either timestamp (e.g., \"2026-02-02_121557\") full path (e.g., \"gs://calcofi-files-public/archive/2026-02-02_121557\"). provided, downloads archive instead using local files. gcs_bucket GCS bucket archives (default: \"calcofi-files-public\") archive_prefix Prefix archive folder (default: \"archive\") sync_archive Whether sync local files GCS archive (default: TRUE). applies using dir_data (local files). verbose Print detailed messages. Default: FALSE","code":""},{"path":"https://calcofi.io/calcofi4db/reference/read_csv_files.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read CSV Files and Their Metadata — read_csv_files","text":"list containing: d_csv List CSV data including: - data: tibble columns (tbl, csv, file_size, last_modified, data, nrow, ncol, flds, gcs_path) - tables: summary tables (tbl, nrow, ncol) - fields: summary fields (tbl, fld, type) source_files Data frame provenance tracking columns: table, local_path, gcs_path, file_size, last_modified, nrow, ncol d_tbls_rd Table redefinition data frame columns: tbl_old, tbl_new, tbl_description d_flds_rd Field redefinition data frame columns: tbl_old, tbl_new, fld_old, fld_new, order_old, order_new, type_old, type_new, fld_description, notes, mutation paths List file paths used workflow","code":""},{"path":"https://calcofi.io/calcofi4db/reference/read_csv_files.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Read CSV Files and Their Metadata — read_csv_files","text":"Reads CSV files local directory downloads GCS archive using local files, syncs GCS archive immutable provenance Extracts metadata tables fields CSV files Creates reads redefinition files table field transformations function returns comprehensive data structure containing: Raw CSV data metadata (d_csv) Source files provenance tracking (source_files) Table redefinitions (d_tbls_rd) renaming/describing tables Field redefinitions (d_flds_rd) renaming/typing/transforming fields File paths used workflow","code":""},{"path":"https://calcofi.io/calcofi4db/reference/read_csv_files.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Read CSV Files and Their Metadata — read_csv_files","text":"","code":"if (FALSE) { # \\dontrun{ # Read from local Google Drive mount (syncs to GCS archive) d <- read_csv_files(   provider     = \"swfsc.noaa.gov\",   dataset      = \"calcofi-db\",   dir_data     = \"~/My Drive/projects/calcofi/data-public\",   metadata_dir = \"metadata\")  # Read from specific GCS archive (for reproducibility) d <- read_csv_files(   provider     = \"swfsc.noaa.gov\",   dataset      = \"calcofi-db\",   gcs_archive  = \"2026-02-02_121557\",   metadata_dir = \"metadata\")  # Access the raw CSV data d$d_csv$data  # Check source file provenance d$source_files } # }"},{"path":"https://calcofi.io/calcofi4db/reference/read_csv_metadata.html","id":null,"dir":"Reference","previous_headings":"","what":"Read CSV Files and Extract Metadata — read_csv_metadata","title":"Read CSV Files and Extract Metadata — read_csv_metadata","text":"Reads CSV files directory, extracts metadata tables fields, writes metadata files processing.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/read_csv_metadata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read CSV Files and Extract Metadata — read_csv_metadata","text":"","code":"read_csv_metadata(dir_csv, dir_ingest, create_dirs = TRUE)"},{"path":"https://calcofi.io/calcofi4db/reference/read_csv_metadata.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read CSV Files and Extract Metadata — read_csv_metadata","text":"dir_csv Directory containing CSV files dir_ingest Directory store metadata files create_dirs Whether create directories exist","code":""},{"path":"https://calcofi.io/calcofi4db/reference/read_csv_metadata.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read CSV Files and Extract Metadata — read_csv_metadata","text":"list two data frames: tables fields metadata","code":""},{"path":"https://calcofi.io/calcofi4db/reference/read_csv_metadata.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Read CSV Files and Extract Metadata — read_csv_metadata","text":"","code":"if (FALSE) { # \\dontrun{ csv_metadata <- read_csv_metadata(   dir_csv = \"/path/to/data/provider/dataset\",   dir_ingest = \"/path/to/ingest/provider/dataset\") } # }"},{"path":"https://calcofi.io/calcofi4db/reference/read_ingest_manifest.html","id":null,"dir":"Reference","previous_headings":"","what":"Read Ingest Manifest from GCS — read_ingest_manifest","title":"Read Ingest Manifest from GCS — read_ingest_manifest","text":"Retrieves manifest.json specific ingest workflow output.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/read_ingest_manifest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read Ingest Manifest from GCS — read_ingest_manifest","text":"","code":"read_ingest_manifest(provider, dataset, gcs_bucket = \"calcofi-db\")"},{"path":"https://calcofi.io/calcofi4db/reference/read_ingest_manifest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read Ingest Manifest from GCS — read_ingest_manifest","text":"provider Data provider (e.g., \"swfsc.noaa.gov\") dataset Dataset name (e.g., \"calcofi-db\") gcs_bucket GCS bucket (default: \"calcofi-db\")","code":""},{"path":"https://calcofi.io/calcofi4db/reference/read_ingest_manifest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read Ingest Manifest from GCS — read_ingest_manifest","text":"List containing manifest data","code":""},{"path":"https://calcofi.io/calcofi4db/reference/read_ingest_manifest.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Read Ingest Manifest from GCS — read_ingest_manifest","text":"","code":"if (FALSE) { # \\dontrun{ manifest <- read_ingest_manifest(   provider = \"swfsc.noaa.gov\",   dataset  = \"calcofi-db\")  manifest$source_files manifest$tables } # }"},{"path":"https://calcofi.io/calcofi4db/reference/read_ingest_parquet.html","id":null,"dir":"Reference","previous_headings":"","what":"Read Ingest Parquet Table from GCS — read_ingest_parquet","title":"Read Ingest Parquet Table from GCS — read_ingest_parquet","text":"Downloads reads parquet table ingest output.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/read_ingest_parquet.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read Ingest Parquet Table from GCS — read_ingest_parquet","text":"","code":"read_ingest_parquet(provider, dataset, table, gcs_bucket = \"calcofi-db\")"},{"path":"https://calcofi.io/calcofi4db/reference/read_ingest_parquet.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read Ingest Parquet Table from GCS — read_ingest_parquet","text":"provider Data provider (e.g., \"swfsc.noaa.gov\") dataset Dataset name (e.g., \"calcofi-db\") table Table name (e.g., \"cruise\") gcs_bucket GCS bucket (default: \"calcofi-db\")","code":""},{"path":"https://calcofi.io/calcofi4db/reference/read_ingest_parquet.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read Ingest Parquet Table from GCS — read_ingest_parquet","text":"Data frame (tibble) table","code":""},{"path":"https://calcofi.io/calcofi4db/reference/read_ingest_parquet.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Read Ingest Parquet Table from GCS — read_ingest_parquet","text":"","code":"if (FALSE) { # \\dontrun{ cruise <- read_ingest_parquet(   provider = \"swfsc.noaa.gov\",   dataset  = \"calcofi-db\",   table    = \"cruise\") } # }"},{"path":"https://calcofi.io/calcofi4db/reference/read_parquet_table.html","id":null,"dir":"Reference","previous_headings":"","what":"Read a Parquet table — read_parquet_table","title":"Read a Parquet table — read_parquet_table","text":"Reads Parquet file data frame lazy Arrow Table.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/read_parquet_table.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read a Parquet table — read_parquet_table","text":"","code":"read_parquet_table(path, lazy = FALSE, columns = NULL)"},{"path":"https://calcofi.io/calcofi4db/reference/read_parquet_table.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read a Parquet table — read_parquet_table","text":"path Path Parquet file (local GCS) lazy TRUE, returns Arrow Table lazy evaluation (default: FALSE) columns Optional vector column names read (default: )","code":""},{"path":"https://calcofi.io/calcofi4db/reference/read_parquet_table.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read a Parquet table — read_parquet_table","text":"Data frame Arrow Table","code":""},{"path":"https://calcofi.io/calcofi4db/reference/read_parquet_table.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Read a Parquet table — read_parquet_table","text":"","code":"if (FALSE) { # \\dontrun{ # read as data frame df <- read_parquet_table(\"parquet/bottle.parquet\")  # read as lazy Arrow table for large files tbl <- read_parquet_table(\"parquet/bottle.parquet\", lazy = TRUE)  # read only specific columns df <- read_parquet_table(\"parquet/bottle.parquet\", columns = c(\"cruise_id\", \"depth\")) } # }"},{"path":"https://calcofi.io/calcofi4db/reference/record_schema_version.html","id":null,"dir":"Reference","previous_headings":"","what":"Record Schema Version — record_schema_version","title":"Record Schema Version — record_schema_version","text":"Records new schema version schema_version table metadata ingestion. function called successful completion dataset ingestions relationship creation.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/record_schema_version.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Record Schema Version — record_schema_version","text":"","code":"record_schema_version(   con,   schema = \"dev\",   version,   description,   script_permalink )"},{"path":"https://calcofi.io/calcofi4db/reference/record_schema_version.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Record Schema Version — record_schema_version","text":"con Database connection object schema Schema name (default: \"dev\") version Semantic version number (e.g., \"1.0.0\", \"1.1.0\") description Description changes version script_permalink GitHub permalink versioned ingestion script","code":""},{"path":"https://calcofi.io/calcofi4db/reference/record_schema_version.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Record Schema Version — record_schema_version","text":"Invisible NULL (version recorded database CSV file)","code":""},{"path":"https://calcofi.io/calcofi4db/reference/record_schema_version.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Record Schema Version — record_schema_version","text":"function: Creates schema_version table exist Reads existing versions inst/schema_version.csv Inserts new version record database Appends new version inst/schema_version.csv","code":""},{"path":"https://calcofi.io/calcofi4db/reference/record_schema_version.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Record Schema Version — record_schema_version","text":"","code":"if (FALSE) { # \\dontrun{ record_schema_version(   con = con,   schema = \"dev\",   version = \"1.0.0\",   description = \"Initial ingestion of NOAA CalCOFI Database\",   script_permalink = \"https://github.com/CalCOFI/calcofi4db/blob/abc123/inst/create_db.qmd\" ) } # }"},{"path":"https://calcofi.io/calcofi4db/reference/render_integrity_message.html","id":null,"dir":"Reference","previous_headings":"","what":"Render Data Integrity Check Message — render_integrity_message","title":"Render Data Integrity Check Message — render_integrity_message","text":"Renders markdown message check_data_integrity() output. Use output: asis chunks display formatted messages.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/render_integrity_message.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Render Data Integrity Check Message — render_integrity_message","text":"","code":"render_integrity_message(integrity_check)"},{"path":"https://calcofi.io/calcofi4db/reference/render_integrity_message.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Render Data Integrity Check Message — render_integrity_message","text":"integrity_check List output check_data_integrity()","code":""},{"path":"https://calcofi.io/calcofi4db/reference/render_integrity_message.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Render Data Integrity Check Message — render_integrity_message","text":"Invisible NULL (message rendered via cat())","code":""},{"path":"https://calcofi.io/calcofi4db/reference/render_integrity_message.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Render Data Integrity Check Message — render_integrity_message","text":"","code":"if (FALSE) { # \\dontrun{ # In a Quarto chunk with output: asis integrity_check <- check_data_integrity(d, \"NOAA CalCOFI Database\") render_integrity_message(integrity_check) } # }"},{"path":"https://calcofi.io/calcofi4db/reference/replace_uuid_with_id.html","id":null,"dir":"Reference","previous_headings":"","what":"Replace UUIDs with Integer Foreign Keys — replace_uuid_with_id","title":"Replace UUIDs with Integer Foreign Keys — replace_uuid_with_id","text":"Creates integer ID column populates based UUID lookups, optionally drops UUID column.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/replace_uuid_with_id.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Replace UUIDs with Integer Foreign Keys — replace_uuid_with_id","text":"","code":"replace_uuid_with_id(   con,   table_name,   uuid_col,   new_id_col,   ref_table,   ref_uuid_col,   ref_id_col,   drop_uuid = TRUE )"},{"path":"https://calcofi.io/calcofi4db/reference/replace_uuid_with_id.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Replace UUIDs with Integer Foreign Keys — replace_uuid_with_id","text":"con DuckDB connection table_name Table update uuid_col Name UUID column replace new_id_col Name new integer ID column ref_table Reference table containing UUID--ID mapping ref_uuid_col UUID column reference table ref_id_col ID column reference table drop_uuid Whether drop UUID column replacement (default: TRUE)","code":""},{"path":"https://calcofi.io/calcofi4db/reference/replace_uuid_with_id.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Replace UUIDs with Integer Foreign Keys — replace_uuid_with_id","text":"Invisibly returns connection","code":""},{"path":"https://calcofi.io/calcofi4db/reference/replace_uuid_with_id.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Replace UUIDs with Integer Foreign Keys — replace_uuid_with_id","text":"","code":"if (FALSE) { # \\dontrun{ # replace site_uuid with site_id FK replace_uuid_with_id(   con         = con,   table_name  = \"tow\",   uuid_col    = \"site_uuid\",   new_id_col  = \"site_id\",   ref_table   = \"site\",   ref_uuid_col = \"site_uuid\",   ref_id_col  = \"site_id\") } # }"},{"path":"https://calcofi.io/calcofi4db/reference/save_duckdb_to_gcs.html","id":null,"dir":"Reference","previous_headings":"","what":"Save DuckDB to GCS — save_duckdb_to_gcs","title":"Save DuckDB to GCS — save_duckdb_to_gcs","text":"Saves DuckDB database file Google Cloud Storage.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/save_duckdb_to_gcs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Save DuckDB to GCS — save_duckdb_to_gcs","text":"","code":"save_duckdb_to_gcs(con, gcs_path, checkpoint = TRUE)"},{"path":"https://calcofi.io/calcofi4db/reference/save_duckdb_to_gcs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Save DuckDB to GCS — save_duckdb_to_gcs","text":"con DuckDB connection gcs_path GCS path (e.g., \"gs://calcofi-db/duckdb/calcofi.duckdb\") checkpoint Run checkpoint saving ensure data flushed","code":""},{"path":"https://calcofi.io/calcofi4db/reference/save_duckdb_to_gcs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Save DuckDB to GCS — save_duckdb_to_gcs","text":"GCS URI uploaded file","code":""},{"path":"https://calcofi.io/calcofi4db/reference/save_duckdb_to_gcs.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Save DuckDB to GCS — save_duckdb_to_gcs","text":"","code":"if (FALSE) { # \\dontrun{ save_duckdb_to_gcs(con, \"gs://calcofi-db/duckdb/calcofi.duckdb\") } # }"},{"path":"https://calcofi.io/calcofi4db/reference/save_working_ducklake.html","id":null,"dir":"Reference","previous_headings":"","what":"Save Working DuckLake to GCS — save_working_ducklake","title":"Save Working DuckLake to GCS — save_working_ducklake","text":"Uploads Working DuckLake database file Google Cloud Storage. called ingestion workflows complete persist changes.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/save_working_ducklake.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Save Working DuckLake to GCS — save_working_ducklake","text":"","code":"save_working_ducklake(   con,   gcs_path = \"gs://calcofi-db/ducklake/working/calcofi.duckdb\",   checkpoint = TRUE )"},{"path":"https://calcofi.io/calcofi4db/reference/save_working_ducklake.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Save Working DuckLake to GCS — save_working_ducklake","text":"con DuckDB connection get_working_ducklake() gcs_path GCS destination path (default: \"gs://calcofi-db/ducklake/working/calcofi.duckdb\") checkpoint Run checkpoint upload (default: TRUE)","code":""},{"path":"https://calcofi.io/calcofi4db/reference/save_working_ducklake.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Save Working DuckLake to GCS — save_working_ducklake","text":"GCS URI uploaded file","code":""},{"path":"https://calcofi.io/calcofi4db/reference/save_working_ducklake.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Save Working DuckLake to GCS — save_working_ducklake","text":"","code":"if (FALSE) { # \\dontrun{ con <- get_working_ducklake() # ... perform ingestion ... save_working_ducklake(con) close_duckdb(con) } # }"},{"path":"https://calcofi.io/calcofi4db/reference/set_duckdb_comments.html","id":null,"dir":"Reference","previous_headings":"","what":"Set table and column comments in DuckDB — set_duckdb_comments","title":"Set table and column comments in DuckDB — set_duckdb_comments","text":"Adds documentation comments tables columns DuckDB.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/set_duckdb_comments.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set table and column comments in DuckDB — set_duckdb_comments","text":"","code":"set_duckdb_comments(con, table, table_comment = NULL, column_comments = NULL)"},{"path":"https://calcofi.io/calcofi4db/reference/set_duckdb_comments.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set table and column comments in DuckDB — set_duckdb_comments","text":"con DuckDB connection table Table name table_comment Optional table-level comment column_comments Named list column comments","code":""},{"path":"https://calcofi.io/calcofi4db/reference/set_duckdb_comments.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set table and column comments in DuckDB — set_duckdb_comments","text":"connection (invisibly)","code":""},{"path":"https://calcofi.io/calcofi4db/reference/set_duckdb_comments.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Set table and column comments in DuckDB — set_duckdb_comments","text":"","code":"if (FALSE) { # \\dontrun{ set_duckdb_comments(   con,   table = \"bottle\",   table_comment = \"Bottle sample data from CalCOFI cruises\",   column_comments = list(     cruise_id = \"Unique cruise identifier\",     depth_m   = \"Sample depth in meters\",     temp_c    = \"Water temperature in Celsius\")) } # }"},{"path":"https://calcofi.io/calcofi4db/reference/show_fields_redefine.html","id":null,"dir":"Reference","previous_headings":"","what":"Show fields to redefine — show_fields_redefine","title":"Show fields to redefine — show_fields_redefine","text":"Show tables redefine","code":""},{"path":"https://calcofi.io/calcofi4db/reference/show_fields_redefine.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Show fields to redefine — show_fields_redefine","text":"","code":"show_fields_redefine(d)"},{"path":"https://calcofi.io/calcofi4db/reference/show_fields_redefine.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Show fields to redefine — show_fields_redefine","text":"d data object output read_csv_files()","code":""},{"path":"https://calcofi.io/calcofi4db/reference/show_fields_redefine.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Show fields to redefine — show_fields_redefine","text":"Data frame tables redefine","code":""},{"path":"https://calcofi.io/calcofi4db/reference/show_fields_rename.html","id":null,"dir":"Reference","previous_headings":"","what":"Show fields to redefine — show_fields_redefine","title":"Show fields to redefine — show_fields_redefine","text":"Show tables redefine","code":""},{"path":"https://calcofi.io/calcofi4db/reference/show_fields_rename.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Show fields to redefine — show_fields_redefine","text":"","code":"show_fields_redefine(d)"},{"path":"https://calcofi.io/calcofi4db/reference/show_fields_rename.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Show fields to redefine — show_fields_redefine","text":"d data object output read_csv_files()","code":""},{"path":"https://calcofi.io/calcofi4db/reference/show_fields_rename.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Show fields to redefine — show_fields_redefine","text":"Data frame tables redefine","code":""},{"path":"https://calcofi.io/calcofi4db/reference/show_flagged_file.html","id":null,"dir":"Reference","previous_headings":"","what":"Show Flagged File Result — show_flagged_file","title":"Show Flagged File Result — show_flagged_file","text":"Displays result flag_invalid_rows() GitHub link flagged file summary statistics.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/show_flagged_file.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Show Flagged File Result — show_flagged_file","text":"","code":"show_flagged_file(   invalid_rows,   output_path,   description,   repo = \"CalCOFI/workflows\",   branch = \"main\" )"},{"path":"https://calcofi.io/calcofi4db/reference/show_flagged_file.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Show Flagged File Result — show_flagged_file","text":"invalid_rows Tibble invalid rows flagged output_path Path flagged CSV file description Description flagged repo GitHub repository (default: \"CalCOFI/workflows\") branch Git branch (default: \"main\")","code":""},{"path":"https://calcofi.io/calcofi4db/reference/show_flagged_file.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Show Flagged File Result — show_flagged_file","text":"HTML string flagged file summary link","code":""},{"path":"https://calcofi.io/calcofi4db/reference/show_flagged_file.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Show Flagged File Result — show_flagged_file","text":"","code":"if (FALSE) { # \\dontrun{ invalid_stages <- validate_egg_stages(con, \"egg_stage\", \"stage\") if (nrow(invalid_stages) > 0) {   output_path <- flag_invalid_rows(invalid_stages, \"data/flagged/invalid_egg_stages.csv\", \"Invalid egg stages\")   show_flagged_file(invalid_stages, output_path, \"Invalid egg stages\") } } # }"},{"path":"https://calcofi.io/calcofi4db/reference/show_googledrive_files.html","id":null,"dir":"Reference","previous_headings":"","what":"Show Google Drive files — show_googledrive_files","title":"Show Google Drive files — show_googledrive_files","text":"Show Google Drive files","code":""},{"path":"https://calcofi.io/calcofi4db/reference/show_googledrive_files.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Show Google Drive files — show_googledrive_files","text":"","code":"show_googledrive_files(d)"},{"path":"https://calcofi.io/calcofi4db/reference/show_googledrive_files.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Show Google Drive files — show_googledrive_files","text":"d data object output read_csv_files()","code":""},{"path":"https://calcofi.io/calcofi4db/reference/show_googledrive_files.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Show Google Drive files — show_googledrive_files","text":"Data frame Google Drive files","code":""},{"path":"https://calcofi.io/calcofi4db/reference/show_source_files.html","id":null,"dir":"Reference","previous_headings":"","what":"Show source files — show_source_files","title":"Show source files — show_source_files","text":"Show source CSV files local GCS paths provenance","code":""},{"path":"https://calcofi.io/calcofi4db/reference/show_source_files.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Show source files — show_source_files","text":"","code":"show_source_files(d)"},{"path":"https://calcofi.io/calcofi4db/reference/show_source_files.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Show source files — show_source_files","text":"d data object output read_csv_files()","code":""},{"path":"https://calcofi.io/calcofi4db/reference/show_source_files.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Show source files — show_source_files","text":"DT datatable showing source files paths row counts","code":""},{"path":"https://calcofi.io/calcofi4db/reference/show_tables_redefine.html","id":null,"dir":"Reference","previous_headings":"","what":"Show tables to redefine — show_tables_redefine","title":"Show tables to redefine — show_tables_redefine","text":"Show tables redefine","code":""},{"path":"https://calcofi.io/calcofi4db/reference/show_tables_redefine.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Show tables to redefine — show_tables_redefine","text":"","code":"show_tables_redefine(d)"},{"path":"https://calcofi.io/calcofi4db/reference/show_tables_redefine.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Show tables to redefine — show_tables_redefine","text":"d data object output read_csv_files()","code":""},{"path":"https://calcofi.io/calcofi4db/reference/show_tables_redefine.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Show tables to redefine — show_tables_redefine","text":"Data frame tables redefine","code":""},{"path":"https://calcofi.io/calcofi4db/reference/show_validation_results.html","id":null,"dir":"Reference","previous_headings":"","what":"Show Validation Results with GitHub Links — show_validation_results","title":"Show Validation Results with GitHub Links — show_validation_results","text":"Displays validation results validate_dataset() datatable output_file paths converted clickable GitHub links.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/show_validation_results.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Show Validation Results with GitHub Links — show_validation_results","text":"","code":"show_validation_results(   validation_results,   caption = \"Validation Results\",   repo = \"CalCOFI/workflows\",   branch = \"main\" )"},{"path":"https://calcofi.io/calcofi4db/reference/show_validation_results.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Show Validation Results with GitHub Links — show_validation_results","text":"validation_results Results validate_dataset() containing $checks tibble caption Table caption (default: \"Validation Results\") repo GitHub repository (default: \"CalCOFI/workflows\") branch Git branch (default: \"main\")","code":""},{"path":"https://calcofi.io/calcofi4db/reference/show_validation_results.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Show Validation Results with GitHub Links — show_validation_results","text":"DT datatable object","code":""},{"path":"https://calcofi.io/calcofi4db/reference/show_validation_results.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Show Validation Results with GitHub Links — show_validation_results","text":"","code":"if (FALSE) { # \\dontrun{ validation_results <- validate_dataset(con, validations, output_dir) show_validation_results(validation_results) } # }"},{"path":"https://calcofi.io/calcofi4db/reference/strip_provenance_columns.html","id":null,"dir":"Reference","previous_headings":"","what":"Strip provenance columns from data — strip_provenance_columns","title":"Strip provenance columns from data — strip_provenance_columns","text":"Removes provenance tracking columns (_source_file, _source_row, _source_uuid, _ingested_at) data frame. Used preparing data frozen releases.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/strip_provenance_columns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Strip provenance columns from data — strip_provenance_columns","text":"","code":"strip_provenance_columns(data)"},{"path":"https://calcofi.io/calcofi4db/reference/strip_provenance_columns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Strip provenance columns from data — strip_provenance_columns","text":"data Data frame provenance columns","code":""},{"path":"https://calcofi.io/calcofi4db/reference/strip_provenance_columns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Strip provenance columns from data — strip_provenance_columns","text":"Data frame without provenance columns","code":""},{"path":"https://calcofi.io/calcofi4db/reference/strip_provenance_columns.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Strip provenance columns from data — strip_provenance_columns","text":"","code":"if (FALSE) { # \\dontrun{ # strip provenance for public release clean_data <- strip_provenance_columns(data_with_prov) } # }"},{"path":"https://calcofi.io/calcofi4db/reference/suggest_next_version.html","id":null,"dir":"Reference","previous_headings":"","what":"Suggest Next Version — suggest_next_version","title":"Suggest Next Version — suggest_next_version","text":"Suggests next version based current version type change.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/suggest_next_version.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Suggest Next Version — suggest_next_version","text":"","code":"suggest_next_version(change_type = \"patch\")"},{"path":"https://calcofi.io/calcofi4db/reference/suggest_next_version.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Suggest Next Version — suggest_next_version","text":"change_type Type change: \"major\", \"minor\", \"patch\" (default: \"patch\")","code":""},{"path":"https://calcofi.io/calcofi4db/reference/suggest_next_version.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Suggest Next Version — suggest_next_version","text":"Character string suggested next version","code":""},{"path":"https://calcofi.io/calcofi4db/reference/suggest_next_version.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Suggest Next Version — suggest_next_version","text":"","code":"if (FALSE) { # \\dontrun{ suggest_next_version(\"minor\")  # If current is 1.0.0, suggests 1.1.0 suggest_next_version(\"major\")  # If current is 1.0.0, suggests 2.0.0 } # }"},{"path":"https://calcofi.io/calcofi4db/reference/sync_to_gcs_archive.html","id":null,"dir":"Reference","previous_headings":"","what":"Sync local files to GCS archive — sync_to_gcs_archive","title":"Sync local files to GCS archive — sync_to_gcs_archive","text":"Creates new timestamped archive GCS local files. creates new archive local files differ latest archive.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/sync_to_gcs_archive.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sync local files to GCS archive — sync_to_gcs_archive","text":"","code":"sync_to_gcs_archive(   dir_csv,   provider,   dataset,   gcs_bucket = \"calcofi-files-public\",   archive_prefix = \"archive\",   force = FALSE )"},{"path":"https://calcofi.io/calcofi4db/reference/sync_to_gcs_archive.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sync local files to GCS archive — sync_to_gcs_archive","text":"dir_csv Local directory containing CSV files provider Data provider dataset Dataset name gcs_bucket GCS bucket name archive_prefix Archive folder prefix force Force creation even files match latest archive","code":""},{"path":"https://calcofi.io/calcofi4db/reference/sync_to_gcs_archive.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sync local files to GCS archive — sync_to_gcs_archive","text":"List : archive_timestamp: Timestamp archive used/created archive_path: Full GCS path archive created_new: Logical, TRUE new archive created files_uploaded: Number files uploaded (0 using existing)","code":""},{"path":"https://calcofi.io/calcofi4db/reference/sync_to_gcs_archive.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sync local files to GCS archive — sync_to_gcs_archive","text":"","code":"if (FALSE) { # \\dontrun{ result <- sync_to_gcs_archive(   dir_csv  = \"/path/to/csv\",   provider = \"swfsc.noaa.gov\",   dataset  = \"calcofi-db\")  message(glue(\"Using archive: {result$archive_timestamp}\")) } # }"},{"path":"https://calcofi.io/calcofi4db/reference/transform_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Transform Data for Database Ingestion — transform_data","title":"Transform Data for Database Ingestion — transform_data","text":"Applies transformations raw data based redefinition files.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/transform_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Transform Data for Database Ingestion — transform_data","text":"","code":"transform_data(data_info)"},{"path":"https://calcofi.io/calcofi4db/reference/transform_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Transform Data for Database Ingestion — transform_data","text":"data_info List containing data metadata read_csv_files()","code":""},{"path":"https://calcofi.io/calcofi4db/reference/transform_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Transform Data for Database Ingestion — transform_data","text":"List transformed data ready database ingestion","code":""},{"path":"https://calcofi.io/calcofi4db/reference/transform_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Transform Data for Database Ingestion — transform_data","text":"","code":"if (FALSE) { # \\dontrun{ transformed_data <- transform_data(data_info) } # }"},{"path":"https://calcofi.io/calcofi4db/reference/update_package_version.html","id":null,"dir":"Reference","previous_headings":"","what":"Synchronized Version Management for Package and Database — update_package_version","title":"Synchronized Version Management for Package and Database — update_package_version","text":"functions manage synchronized versioning R package, database schema, NEWS.md file, git commits GitHub permalinks. Update Package Version NEWS","code":""},{"path":"https://calcofi.io/calcofi4db/reference/update_package_version.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Synchronized Version Management for Package and Database — update_package_version","text":"","code":"update_package_version(version, description, news_items = NULL)"},{"path":"https://calcofi.io/calcofi4db/reference/update_package_version.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Synchronized Version Management for Package and Database — update_package_version","text":"version New semantic version number (e.g., \"1.0.0\") description Description changes NEWS.md news_items Character vector bullet points NEWS.md (optional)","code":""},{"path":"https://calcofi.io/calcofi4db/reference/update_package_version.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Synchronized Version Management for Package and Database — update_package_version","text":"List updated version info","code":""},{"path":"https://calcofi.io/calcofi4db/reference/update_package_version.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Synchronized Version Management for Package and Database — update_package_version","text":"Updates package DESCRIPTION version prepends new entry NEWS.md. called committing recording schema version.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/update_package_version.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Synchronized Version Management for Package and Database — update_package_version","text":"","code":"if (FALSE) { # \\dontrun{ update_package_version(   version = \"1.0.0\",   description = \"Initial production release\",   news_items = c(     \"Complete NOAA CalCOFI Database ingestion\",     \"Add schema versioning system\",     \"Create master ingestion workflow\"   ) ) } # }"},{"path":"https://calcofi.io/calcofi4db/reference/upload_parquet.html","id":null,"dir":"Reference","previous_headings":"","what":"Upload Parquet file to GCS — upload_parquet","title":"Upload Parquet file to GCS — upload_parquet","text":"Convenience function upload Parquet file calcofi-db bucket.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/upload_parquet.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Upload Parquet file to GCS — upload_parquet","text":"","code":"upload_parquet(local_path, gcs_path, bucket = \"calcofi-db\")"},{"path":"https://calcofi.io/calcofi4db/reference/upload_parquet.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Upload Parquet file to GCS — upload_parquet","text":"local_path Path local Parquet file gcs_path Relative path calcofi-db bucket (e.g., \"parquet/bottle.parquet\") bucket GCS bucket name (default: \"calcofi-db\")","code":""},{"path":"https://calcofi.io/calcofi4db/reference/upload_parquet.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Upload Parquet file to GCS — upload_parquet","text":"GCS URI uploaded file","code":""},{"path":"https://calcofi.io/calcofi4db/reference/upload_parquet.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Upload Parquet file to GCS — upload_parquet","text":"","code":"if (FALSE) { # \\dontrun{ upload_parquet(\"local/bottle.parquet\", \"parquet/bottle.parquet\") } # }"},{"path":"https://calcofi.io/calcofi4db/reference/validate_dataset.html","id":null,"dir":"Reference","previous_headings":"","what":"Run All Validations for a Dataset — validate_dataset","title":"Run All Validations for a Dataset — validate_dataset","text":"Runs set validation checks database exports flagged rows. Returns summary validation results.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/validate_dataset.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run All Validations for a Dataset — validate_dataset","text":"","code":"validate_dataset(con, validations, output_dir = \"data/flagged\")"},{"path":"https://calcofi.io/calcofi4db/reference/validate_dataset.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run All Validations for a Dataset — validate_dataset","text":"con DuckDB connection validations List validation definitions, containing: type: \"fk\" (foreign key) \"lookup\" (lookup value) data_tbl: Table validate col: Column check ref_tbl: Reference table (fk) lookup_type (lookup) ref_col: Reference column (fk ) output_file: Filename flagged rows (placed output_dir) description: Human-readable description output_dir Directory flagged CSV files (default: \"data/flagged\")","code":""},{"path":"https://calcofi.io/calcofi4db/reference/validate_dataset.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run All Validations for a Dataset — validate_dataset","text":"List containing: checks: Tibble summarizing validation check total_flagged: Total number flagged rows flagged_files: Vector created flagged file paths invalid_data: List invalid data tibbles check name","code":""},{"path":"https://calcofi.io/calcofi4db/reference/validate_dataset.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run All Validations for a Dataset — validate_dataset","text":"","code":"if (FALSE) { # \\dontrun{ validations <- list(   list(     type        = \"fk\",     data_tbl    = \"ichthyo\",     col         = \"species_id\",     ref_tbl     = \"species\",     ref_col     = \"species_id\",     output_file = \"orphan_species.csv\",     description = \"Species IDs not found in species table\"),   list(     type        = \"fk\",     data_tbl    = \"ichthyo\",     col         = \"net_id\",     ref_tbl     = \"net\",     ref_col     = \"net_id\",     output_file = \"orphan_nets.csv\",     description = \"Net IDs not found in net table\"),   list(     type        = \"lookup\",     data_tbl    = \"ichthyo\",     col         = \"measurement_value\",     ref_tbl     = \"egg_stage\",     output_file = \"invalid_egg_stages.csv\",     description = \"Egg stage values not in vocabulary\"))  results <- validate_dataset(con, validations, output_dir = \"data/flagged\") results$checks |> print() } # }"},{"path":"https://calcofi.io/calcofi4db/reference/validate_egg_stages.html","id":null,"dir":"Reference","previous_headings":"","what":"Validate Egg Stage Values — validate_egg_stages","title":"Validate Egg Stage Values — validate_egg_stages","text":"Specific validation egg stages - checks values valid range (1-11 per Moser & Ahlstrom 1985). Values 12-15 invalid.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/validate_egg_stages.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Validate Egg Stage Values — validate_egg_stages","text":"","code":"validate_egg_stages(con, table_name, stage_col = \"stage\")"},{"path":"https://calcofi.io/calcofi4db/reference/validate_egg_stages.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Validate Egg Stage Values — validate_egg_stages","text":"con DuckDB connection table_name Table containing egg stage data stage_col Column containing stage values (default: \"stage\")","code":""},{"path":"https://calcofi.io/calcofi4db/reference/validate_egg_stages.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Validate Egg Stage Values — validate_egg_stages","text":"Tibble rows invalid egg stage values (>11)","code":""},{"path":"https://calcofi.io/calcofi4db/reference/validate_egg_stages.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Validate Egg Stage Values — validate_egg_stages","text":"","code":"if (FALSE) { # \\dontrun{ invalid_stages <- validate_egg_stages(con, \"eggstage\", \"stage\") } # }"},{"path":"https://calcofi.io/calcofi4db/reference/validate_fk_references.html","id":null,"dir":"Reference","previous_headings":"","what":"Validate Foreign Key References — validate_fk_references","title":"Validate Foreign Key References — validate_fk_references","text":"Checks values foreign key column exist referenced table's primary key column. Returns tibble orphan rows fail check.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/validate_fk_references.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Validate Foreign Key References — validate_fk_references","text":"","code":"validate_fk_references(con, data_tbl, fk_col, ref_tbl, ref_col, label = NULL)"},{"path":"https://calcofi.io/calcofi4db/reference/validate_fk_references.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Validate Foreign Key References — validate_fk_references","text":"con DuckDB connection data_tbl Table name lazy tbl containing foreign key column fk_col Name foreign key column validate ref_tbl Name referenced table containing primary key ref_col Name primary key column referenced table label Optional label error messages (default: \"data_tbl.fk_col\")","code":""},{"path":"https://calcofi.io/calcofi4db/reference/validate_fk_references.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Validate Foreign Key References — validate_fk_references","text":"Tibble orphan rows (rows fk_col value ref_tbl.ref_col). Contains columns data_tbl reference fails.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/validate_fk_references.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Validate Foreign Key References — validate_fk_references","text":"","code":"if (FALSE) { # \\dontrun{ con <- get_duckdb_con() orphans <- validate_fk_references(   con     = con,   data_tbl = \"ichthyo\",   fk_col   = \"species_id\",   ref_tbl  = \"species\",   ref_col  = \"species_id\")  if (nrow(orphans) > 0) {   warning(glue(\"Found {nrow(orphans)} orphan species_id values\")) } } # }"},{"path":"https://calcofi.io/calcofi4db/reference/validate_for_release.html","id":null,"dir":"Reference","previous_headings":"","what":"Validate Working DuckLake for release — validate_for_release","title":"Validate Working DuckLake for release — validate_for_release","text":"Runs data quality checks Working DuckLake creating frozen release. Checks include: null required fields, valid value ranges, foreign key integrity, row count expectations, data completeness.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/validate_for_release.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Validate Working DuckLake for release — validate_for_release","text":"","code":"validate_for_release(con, checks = \"all\", strict = FALSE, config = NULL)"},{"path":"https://calcofi.io/calcofi4db/reference/validate_for_release.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Validate Working DuckLake for release — validate_for_release","text":"con DuckDB connection get_working_ducklake() checks Character vector check names run, \"\" (default). Available checks: \"nulls\", \"ranges\", \"foreign_keys\", \"row_counts\", \"completeness\" strict Logical, fail warnings well errors (default: FALSE) config Optional list validation configuration (expected row counts, etc.)","code":""},{"path":"https://calcofi.io/calcofi4db/reference/validate_for_release.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Validate Working DuckLake for release — validate_for_release","text":"List : passed: Logical, TRUE checks passed checks: Tibble individual check results (name, status, message) errors: Character vector error messages warnings: Character vector warning messages","code":""},{"path":"https://calcofi.io/calcofi4db/reference/validate_for_release.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Validate Working DuckLake for release — validate_for_release","text":"","code":"if (FALSE) { # \\dontrun{ con <- get_working_ducklake() validation <- validate_for_release(con) if (validation$passed) {   freeze_release(con, version = \"v2026.02\") } } # }"},{"path":"https://calcofi.io/calcofi4db/reference/validate_lookup_values.html","id":null,"dir":"Reference","previous_headings":"","what":"Validate Lookup Values Exist — validate_lookup_values","title":"Validate Lookup Values Exist — validate_lookup_values","text":"Checks values column exist lookup table given lookup type. Returns tibble rows invalid lookup values.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/validate_lookup_values.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Validate Lookup Values Exist — validate_lookup_values","text":"","code":"validate_lookup_values(   con,   data_tbl,   value_col,   lookup_type,   lookup_tbl = \"lookup\",   lookup_type_col = \"lookup_type\",   lookup_num_col = \"lookup_num\" )"},{"path":"https://calcofi.io/calcofi4db/reference/validate_lookup_values.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Validate Lookup Values Exist — validate_lookup_values","text":"con DuckDB connection data_tbl Table name containing values validate value_col Name column containing values check lookup_type Type lookup validate (e.g., \"egg_stage\", \"larva_stage\") lookup_tbl Name lookup table (default: \"lookup\") lookup_type_col Column lookup table containing type (default: \"lookup_type\") lookup_num_col Column lookup table containing numeric key values (default: \"lookup_num\")","code":""},{"path":"https://calcofi.io/calcofi4db/reference/validate_lookup_values.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Validate Lookup Values Exist — validate_lookup_values","text":"Tibble rows containing invalid lookup values","code":""},{"path":"https://calcofi.io/calcofi4db/reference/validate_lookup_values.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Validate Lookup Values Exist — validate_lookup_values","text":"","code":"if (FALSE) { # \\dontrun{ invalid_stages <- validate_lookup_values(   con         = con,   data_tbl    = \"ichthyo\",   value_col   = \"measurement_value\",   lookup_type = \"egg_stage\") } # }"},{"path":"https://calcofi.io/calcofi4db/reference/write_ingest_outputs.html","id":null,"dir":"Reference","previous_headings":"","what":"Write Ingest Workflow Outputs to GCS — write_ingest_outputs","title":"Write Ingest Workflow Outputs to GCS — write_ingest_outputs","text":"Transforms data writes parquet files + manifest GCS ingest folder. ingest workflow produces parquet files tables manifest tracking provenance back source archive.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/write_ingest_outputs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Write Ingest Workflow Outputs to GCS — write_ingest_outputs","text":"","code":"write_ingest_outputs(   data_info,   provider,   dataset,   gcs_bucket = \"calcofi-db\",   compression = \"snappy\" )"},{"path":"https://calcofi.io/calcofi4db/reference/write_ingest_outputs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Write Ingest Workflow Outputs to GCS — write_ingest_outputs","text":"data_info Output read_csv_files() provider Data provider (e.g., \"swfsc.noaa.gov\") dataset Dataset name (e.g., \"calcofi-db\") gcs_bucket GCS bucket ingest outputs (default: \"calcofi-db\") compression Parquet compression method (default: \"snappy\")","code":""},{"path":"https://calcofi.io/calcofi4db/reference/write_ingest_outputs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Write Ingest Workflow Outputs to GCS — write_ingest_outputs","text":"List : gcs_base: Base GCS path ingest parquet_paths: Named list GCS paths parquet files manifest_path: GCS path manifest.json manifest: manifest data list","code":""},{"path":"https://calcofi.io/calcofi4db/reference/write_ingest_outputs.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Write Ingest Workflow Outputs to GCS — write_ingest_outputs","text":"","code":"if (FALSE) { # \\dontrun{ d <- read_csv_files(   provider     = \"swfsc.noaa.gov\",   dataset      = \"calcofi-db\",   metadata_dir = \"metadata\")  result <- write_ingest_outputs(   data_info  = d,   provider   = \"swfsc.noaa.gov\",   dataset    = \"calcofi-db\")  # check manifest result$manifest$tables } # }"},{"path":"https://calcofi.io/calcofi4db/reference/write_parquet_outputs.html","id":null,"dir":"Reference","previous_headings":"","what":"Write Tables to Parquet Files — write_parquet_outputs","title":"Write Tables to Parquet Files — write_parquet_outputs","text":"Exports tables DuckDB connection parquet files. Optionally strips provenance columns public releases.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/write_parquet_outputs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Write Tables to Parquet Files — write_parquet_outputs","text":"","code":"write_parquet_outputs(   con,   output_dir,   tables = NULL,   strip_provenance = TRUE,   compression = \"snappy\" )"},{"path":"https://calcofi.io/calcofi4db/reference/write_parquet_outputs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Write Tables to Parquet Files — write_parquet_outputs","text":"con DuckDB connection output_dir Directory parquet files tables Optional vector table names export. NULL, exports tables. strip_provenance Remove provenance columns (source*, _ingested_at) (default: TRUE) compression Parquet compression codec (default: \"snappy\")","code":""},{"path":"https://calcofi.io/calcofi4db/reference/write_parquet_outputs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Write Tables to Parquet Files — write_parquet_outputs","text":"Tibble export statistics (table, rows, file_size, path)","code":""},{"path":"https://calcofi.io/calcofi4db/reference/write_parquet_outputs.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Write Tables to Parquet Files — write_parquet_outputs","text":"","code":"if (FALSE) { # \\dontrun{ con <- get_duckdb_con(\"calcofi.duckdb\") stats <- write_parquet_outputs(con, \"output/parquet\") } # }"},{"path":"https://calcofi.io/calcofi4db/reference/write_parquet_table.html","id":null,"dir":"Reference","previous_headings":"","what":"Write data to Parquet format — write_parquet_table","title":"Write data to Parquet format — write_parquet_table","text":"Writes data frame Parquet, optionally partitioning.","code":""},{"path":"https://calcofi.io/calcofi4db/reference/write_parquet_table.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Write data to Parquet format — write_parquet_table","text":"","code":"write_parquet_table(data, path, partitions = NULL, compression = \"snappy\")"},{"path":"https://calcofi.io/calcofi4db/reference/write_parquet_table.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Write data to Parquet format — write_parquet_table","text":"data Data frame write path Output path Parquet file directory (partitioned) partitions Optional character vector columns partition compression Compression codec (default: \"snappy\")","code":""},{"path":"https://calcofi.io/calcofi4db/reference/write_parquet_table.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Write data to Parquet format — write_parquet_table","text":"Path created Parquet file/directory","code":""},{"path":"https://calcofi.io/calcofi4db/reference/write_parquet_table.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Write data to Parquet format — write_parquet_table","text":"","code":"if (FALSE) { # \\dontrun{ # simple write write_parquet_table(df, \"output/data.parquet\")  # partitioned by year and month write_parquet_table(   df,   \"output/data/\",   partitions = c(\"year\", \"month\")) } # }"},{"path":"https://calcofi.io/calcofi4db/news/index.html","id":"calcofi4db-220","dir":"Changelog","previous_headings":"","what":"calcofi4db 2.2.0","title":"calcofi4db 2.2.0","text":"Improvements cloud plan functions Workflow ingest_swfsc.noaa.gov_calcofi-db.qmd now fully automates ingestion CalCOFI database SWFSC NOAA archive parquet files Google Cloud Storage. Many new functions added.","code":""},{"path":"https://calcofi.io/calcofi4db/news/index.html","id":"calcofi4db-210","dir":"Changelog","previous_headings":"","what":"calcofi4db 2.1.0","title":"calcofi4db 2.1.0","text":"Addition functions phase 2 cloud plan Added ducklake freeze functions. Updated documentation concepts.","code":""},{"path":"https://calcofi.io/calcofi4db/news/index.html","id":"calcofi4db-120","dir":"Changelog","previous_headings":"","what":"calcofi4db 1.2.0","title":"calcofi4db 1.2.0","text":"Addition functions phase 1 cloud plan","code":""},{"path":"https://calcofi.io/calcofi4db/news/index.html","id":"calcofi4db-110","dir":"Changelog","previous_headings":"","what":"calcofi4db 1.1.0","title":"calcofi4db 1.1.0","text":"Addition CalCOFI Bottle Database","code":""},{"path":"https://calcofi.io/calcofi4db/news/index.html","id":"calcofi4db-100","dir":"Changelog","previous_headings":"","what":"calcofi4db 1.0.0","title":"calcofi4db 1.0.0","text":"Initial production release NOAA CalCOFI Database Complete NOAA CalCOFI Database ingestion spatial features Add synchronized versioning system package database Create master ingestion workflow integrity checks Implement comprehensive metadata management","code":""},{"path":"https://calcofi.io/calcofi4db/news/index.html","id":"calcofi4db-011","dir":"Changelog","previous_headings":"","what":"calcofi4db 0.1.1","title":"calcofi4db 0.1.1","text":"Add type mismatch checks fields CSV files. Add print_csv_change_stats() functions textual summary changes. Ensure compatibility multiple output formats: interactive DataTable, static kable, raw tibble. Expand documentation read_csv_files() detect_csv_changes().","code":""}]
