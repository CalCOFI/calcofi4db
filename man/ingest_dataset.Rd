% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ducklake.R
\name{ingest_dataset}
\alias{ingest_dataset}
\title{Ingest Dataset into Working DuckLake}
\usage{
ingest_dataset(con, d, mode = "replace", verbose = TRUE)
}
\arguments{
\item{con}{DuckDB connection from \code{get_working_ducklake()}}

\item{d}{Data object from \code{read_csv_files()}}

\item{mode}{Insert mode: "replace" (default) or "append"}

\item{verbose}{Print progress messages (default: TRUE)}
}
\value{
Tibble with ingestion statistics for each table:
\itemize{
\item \code{tbl}: Original table name
\item \code{tbl_new}: New table name after redefinition
\item \code{gcs_path}: Source file path for provenance
\item \code{rows_input}: Number of rows ingested
\item \code{rows_after}: Total rows in table after ingestion
\item \code{ingested_at}: Timestamp of ingestion
}
}
\description{
High-level function to ingest all tables from a dataset into the Working
DuckLake. This wraps \code{transform_data()} and \code{ingest_to_working()} into a
single operation with proper provenance tracking.
}
\examples{
\dontrun{
# read and ingest dataset
d <- read_csv_files(
  provider     = "swfsc.noaa.gov",
  dataset      = "calcofi-db",
  dir_data     = "~/My Drive/projects/calcofi/data-public",
  metadata_dir = "metadata")

con <- get_working_ducklake()
stats <- ingest_dataset(con, d, mode = "replace")
save_working_ducklake(con)
close_duckdb(con)
}
}
\concept{ducklake}
