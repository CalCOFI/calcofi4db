% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/wrangle.R
\name{consolidate_ichthyo_tables}
\alias{consolidate_ichthyo_tables}
\title{Consolidate Ichthyoplankton Tables into Tidy Format}
\usage{
consolidate_ichthyo_tables(
  con,
  output_tbl = "ichthyo",
  egg_tbl = "egg",
  eggstage_tbl = "egg_stage",
  larva_tbl = "larva",
  larvastage_tbl = "larva_stage",
  larvasize_tbl = "larva_size",
  larva_stage_vocab = NULL,
  net_id_col = "net_uuid"
)
}
\arguments{
\item{con}{DuckDB connection}

\item{output_tbl}{Name of output table (default: "ichthyo")}

\item{egg_tbl}{Name of egg totals table (default: "egg")}

\item{eggstage_tbl}{Name of egg stage table (default: "egg_stage")}

\item{larva_tbl}{Name of larva totals table (default: "larva")}

\item{larvastage_tbl}{Name of larva stage table (default: "larva_stage")}

\item{larvasize_tbl}{Name of larva size table (default: "larva_size")}

\item{larva_stage_vocab}{Tibble mapping stage text (YOLK, PREF, etc.) to integers}

\item{net_id_col}{Name of net identifier column in source tables (default: "net_uuid")}
}
\value{
Invisibly returns the connection after creating ichthyo table
}
\description{
Transforms 5 separate ichthyoplankton tables (egg, eggstage, larva, larvastage,
larvasize) into a single tidy table with columns: net_uuid, species_id, life_stage,
measurement_type, measurement_value, tally.
}
\details{
After calling this function, use \code{replace_uuid_with_id()} to convert net_uuid
to net_id, then \code{assign_sequential_ids()} to add ichthyo_id.
}
\examples{
\dontrun{
larva_vocab <- tibble::tibble(
  stage_txt = c("YOLK", "PREF", "FLEX", "POST", "TRNS"),
  stage_int = 1:5)

consolidate_ichthyo_tables(
  con               = con,
  larva_stage_vocab = larva_vocab)

# then convert net_uuid to net_id
replace_uuid_with_id(
  con          = con,
  table_name   = "ichthyo",
  uuid_col     = "net_uuid",
  new_id_col   = "net_id",
  ref_table    = "net",
  ref_uuid_col = "net_uuid",
  ref_id_col   = "net_id")
}
}
\concept{wrangle}
